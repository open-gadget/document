{"version":3,"file":"static/js/768.cee65187.chunk.js","mappings":"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","sources":["translations/differences/index.tsx","translations/missing/index.tsx","translations/dashboard/index.tsx","translations/index.tsx"],"sourcesContent":["import React from \"react\";\nimport {\n  createSearchParams,\n  Link,\n  useParams,\n  useSearchParams,\n  useNavigate,\n} from \"react-router-dom\";\nimport useSWR from \"swr\";\nimport dayjs from \"dayjs\";\nimport relativeTime from \"dayjs/plugin/relativeTime\";\n\nimport \"./index.scss\";\n\nimport { PageContentContainer } from \"../../ui/atoms/page-content\";\n\ndayjs.extend(relativeTime);\n\ninterface DocumentPopularity {\n  value: number;\n  ranking: number;\n  parentValue: number;\n  parentRanking: number;\n}\n\ntype CountByType = { [key: string]: number };\n\ninterface DocumentDifferences {\n  countByType: CountByType;\n  total: number;\n}\n\ninterface DocumentEdits {\n  modified: string;\n  parentModified: string;\n  commitURL: string;\n  parentCommitURL: string;\n}\n\ninterface Document {\n  mdn_url: string;\n  edits: DocumentEdits;\n  title: string;\n  popularity: DocumentPopularity;\n  differences: DocumentDifferences;\n}\n\ninterface Counts {\n  found: number;\n  total: number;\n  pages: number;\n  noParents: number;\n  cacheMisses: number;\n}\n\ninterface Times {\n  took: number;\n}\n\ninterface FlawLevel {\n  name: string;\n  level: string;\n  ignored: boolean;\n}\n\ninterface Data {\n  counts: Counts;\n  documents: Document[];\n  times: Times;\n  flawLevels: FlawLevel[];\n}\n\ninterface LocaleStorageData {\n  lastLoadTime?: number;\n  defaultSort?: string;\n  defaultSortReverse?: string;\n}\n\ninterface StorageData {\n  [locale: string]: LocaleStorageData;\n}\n\nconst LOCALSTORAGE_KEY = \"translations-dashboard-differences\";\n\nfunction saveStorage(locale: string, data: LocaleStorageData) {\n  try {\n    const stored = JSON.parse(\n      localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\"\n    ) as StorageData;\n    stored[locale] = Object.assign({}, stored[locale] || {}, data);\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(stored));\n  } catch (err) {\n    console.warn(\"Unable to save to localStorage\", err);\n  }\n}\n\nfunction getStorage(locale: string): LocaleStorageData | null {\n  try {\n    const stored = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\");\n    if (stored) {\n      return stored[locale] as LocaleStorageData;\n    }\n  } catch (err) {\n    console.warn(\"Unable to retrieve from localStorage\", err);\n  }\n  return null;\n}\n\nexport function TranslationDifferences() {\n  const { locale = \"en-US\" } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  const [lastData, setLastData] = React.useState<Data | null>(null);\n\n  React.useEffect(() => {\n    if (locale.toLowerCase() === \"en-us\") {\n      navigate(`/${locale}/_translations`);\n    }\n  }, [locale, navigate]);\n\n  React.useEffect(() => {\n    let title = \"All translations\";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    if (lastData) {\n      title = `(${lastData.counts.found.toLocaleString()} found) ${title}`;\n    }\n    document.title = title;\n  }, [lastData, locale]);\n\n  const { data, error, isValidating } = useSWR<Data, Error>(\n    locale.toLowerCase() !== \"en-us\"\n      ? `/_translations/differences/?locale=${locale}`\n      : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      if (\n        !(response.headers.get(\"content-type\") || \"\").includes(\n          \"application/json\"\n        )\n      ) {\n        throw new Error(\n          `Response is not JSON (${response.headers.get(\"content-type\")})`\n        );\n      }\n      return response.json();\n    },\n    {\n      revalidateOnFocus: false,\n    }\n  );\n\n  // Use this to be able to figure out how long the XHR takes when there's no cache\n  const startTime = React.useRef<Date>();\n  React.useEffect(() => {\n    if (locale) {\n      if (!data) {\n        startTime.current = new Date();\n      } else {\n        if (\n          data.counts.cacheMisses > 0 &&\n          data.counts.cacheMisses === data.counts.total &&\n          startTime.current\n        ) {\n          const lastLoadTime =\n            new Date().getTime() - startTime.current.getTime();\n          saveStorage(locale, { lastLoadTime });\n        }\n      }\n    }\n  }, [locale, data]);\n\n  React.useEffect(() => {\n    if (data) {\n      setLastData(data);\n    }\n  }, [data]);\n\n  const lastStorageData = getStorage(locale);\n  const defaultSort = lastStorageData?.defaultSort || \"modified\";\n  const defaultSortReverse = lastStorageData?.defaultSortReverse || \"false\";\n  const sort = searchParams.get(\"sort\") || defaultSort;\n  const sortReverse = JSON.parse(\n    searchParams.get(\"sortReverse\") || defaultSortReverse\n  );\n\n  React.useEffect(() => {\n    saveStorage(\n      locale,\n      Object.assign({}, lastStorageData, {\n        defaultSort: sort,\n        defaultSortReverse: sortReverse,\n      })\n    );\n  }, [locale, sort, sortReverse, lastStorageData]);\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return null;\n  }\n\n  return (\n    <Container>\n      {lastData && !error && isValidating && (\n        <p style={{ float: \"right\" }}>Reloading...</p>\n      )}\n      {!data && !error && !lastData && (\n        <Loading\n          estimate={\n            (lastStorageData && lastStorageData.lastLoadTime) || 30 * 1000\n          }\n        />\n      )}\n      {lastData && (\n        <p style={{ textAlign: \"right\" }}>\n          Go to{\" \"}\n          <Link to={`/${locale}/_translations/missing`}>\n            Missing translations for <b>{locale}</b>\n          </Link>\n        </p>\n      )}\n      {error && <ShowSearchError error={error} />}\n      {lastData && (\n        <div className=\"filter-documents\">\n          <FilterControls />\n          <DocumentsTable\n            counts={lastData.counts}\n            documents={lastData.documents}\n            sort={sort}\n            sortReverse={sortReverse}\n          />\n        </div>\n      )}\n      {data && <BuildTimes times={data.times} />}\n    </Container>\n  );\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"all-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowSearchError({ error }) {\n  return (\n    <div className=\"error-message search-error\">\n      <h3>Search error</h3>\n      <pre>{error.toString()}</pre>\n    </div>\n  );\n}\n\nfunction BuildTimes({ times }: { times: Times }) {\n  function format(ms: number) {\n    if (ms > 1000) {\n      const s = ms / 1000;\n      return `${s.toFixed(1)} seconds`;\n    } else {\n      return `${Math.trunc(ms)} milliseconds`;\n    }\n  }\n  return (\n    <div className=\"search-times\">\n      <p>Time to find all documents {format(times.took)}</p>\n    </div>\n  );\n}\n\nfunction Loading({ estimate }: { estimate: number }) {\n  const startLoadingTime = new Date();\n  const [estimateEndTime] = React.useState(\n    new Date(startLoadingTime.getTime() + estimate)\n  );\n\n  const [, setIncrements] = React.useState(0);\n  React.useEffect(() => {\n    const interval = setInterval(() => {\n      setIncrements((state) => state + 1);\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const distance = estimateEndTime.getTime() - startLoadingTime.getTime();\n  const elapsed = new Date().getTime() - startLoadingTime.getTime();\n  const percent = (100 * elapsed) / distance;\n  return (\n    <div className=\"loading\">\n      <progress id=\"progress\" max=\"100\" value={percent} style={{ margin: 20 }}>\n        {percent}%\n      </progress>\n      <br />\n      <small>\n        Estimated time to finish: {((distance - elapsed) / 1000).toFixed(0)}s{\" \"}\n        {elapsed > distance ? (\n          <span aria-label=\"weird\" role=\"img\">\n            🙃\n          </span>\n        ) : null}\n      </small>\n    </div>\n  );\n}\n\nfunction FilterControls() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [title, setTitle] = React.useState(searchParams.get(\"title\") || \"\");\n  const [url, setURL] = React.useState(searchParams.get(\"url\") || \"\");\n  const [differences, setDifferences] = React.useState(\n    searchParams.get(\"differences\") || \"\"\n  );\n\n  function refreshFilters(reset = false) {\n    const filterParams = createSearchParams(searchParams);\n    for (const [key, value] of [\n      [\"url\", url],\n      [\"title\", title],\n      [\"differences\", differences],\n    ]) {\n      if (!reset && value) {\n        filterParams.set(key, value);\n      } else {\n        filterParams.delete(key);\n      }\n    }\n    filterParams.delete(\"page\");\n    setSearchParams(filterParams);\n  }\n\n  function resetFilters() {\n    setURL(\"\");\n    setTitle(\"\");\n    setDifferences(\"\");\n    refreshFilters(true);\n  }\n\n  return (\n    <div className=\"filters\">\n      <h3>Filters</h3>\n      <form\n        onSubmit={(event) => {\n          event.preventDefault();\n          refreshFilters();\n        }}\n      >\n        <div>\n          <h4>Document</h4>\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document URI\"\n            value={url}\n            onChange={(event) => {\n              setURL(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document title\"\n            value={title}\n            onChange={(event) => {\n              setTitle(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n        </div>\n        <div>\n          <h4>Differences</h4>\n          <input\n            type=\"text\"\n            placeholder=\"E.g. >0 or >=5\"\n            value={differences}\n            onChange={(event) => {\n              setDifferences(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n        </div>\n\n        <div>\n          <h4>&nbsp;</h4>\n          <button type=\"submit\">Filter now</button>{\" \"}\n          {(url || title) && (\n            <button type=\"button\" onClick={resetFilters}>\n              Reset filters\n            </button>\n          )}\n        </div>\n      </form>\n    </div>\n  );\n}\ntype NumericOperation = {\n  operation: \"eq\" | \"gt\" | \"gte\" | \"lt\" | \"lte\";\n  value: number;\n};\n\nfunction getNumericOperation(expression: string): NumericOperation | null {\n  function parseIntOrThrow(v: string) {\n    if (!v) {\n      throw new Error(\"Can't be empty\");\n    }\n\n    const parsed = parseInt(v, 10);\n    if (isNaN(parsed)) {\n      throw new Error(`'${v}' not a valid number`);\n    }\n    return parsed;\n  }\n  try {\n    if (expression.startsWith(\">=\")) {\n      return {\n        operation: \"gte\",\n        value: parseIntOrThrow(expression.replace(\">=\", \"\")),\n      };\n    } else if (expression.startsWith(\">\")) {\n      return {\n        operation: \"gt\",\n        value: parseIntOrThrow(expression.replace(\">\", \"\")),\n      };\n    } else if (expression.startsWith(\"<=\")) {\n      return {\n        operation: \"lte\",\n        value: parseIntOrThrow(expression.replace(\"<=\", \"\")),\n      };\n    } else if (expression.startsWith(\"<\")) {\n      return {\n        operation: \"lt\",\n        value: parseIntOrThrow(expression.replace(\"<\", \"\")),\n      };\n    } else if (expression.startsWith(\"==\") || expression.startsWith(\"=\")) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression.replace(/=/g, \"\")),\n      };\n    } else if (expression) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression),\n      };\n    } else {\n      return null;\n    }\n  } catch (error) {\n    console.warn(error);\n    return null;\n  }\n}\n\nfunction matchNumericOperation(value: number, op: NumericOperation): boolean {\n  if (op.operation === \"eq\") {\n    if (value !== op.value) {\n      return false;\n    }\n  } else if (op.operation === \"gt\") {\n    if (!(value > op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"gte\") {\n    if (!(value >= op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lt\") {\n    if (!(value < op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lte\") {\n    if (!(value <= op.value)) {\n      return false;\n    }\n  } else {\n    throw new Error(`Not implemented operation '${op.operation}'`);\n  }\n  return true;\n}\n\nfunction DocumentsTable({\n  counts,\n  documents,\n  sort,\n  sortReverse,\n}: {\n  counts: Counts;\n  documents: Document[];\n  sort: string;\n  sortReverse: boolean;\n}) {\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  const page = parseInt(searchParams.get(\"page\") || \"1\", 10);\n  const pageSize = parseInt(searchParams.get(\"pageSize\") || \"20\", 10);\n  const filterTitle = searchParams.get(\"title\") || \"\";\n  const filterURL = searchParams.get(\"url\") || \"\";\n  const filterDifferences = searchParams.get(\"differences\") || \"\";\n  const filterDifferencesOperation = getNumericOperation(filterDifferences);\n\n  function TableHead({ id, title }: { id: string; title: string }) {\n    return (\n      <th\n        onClick={() => {\n          if (sort === id) {\n            setSearchParams(\n              createSearchParams({\n                sort: id,\n                sortReverse: JSON.stringify(!sortReverse),\n              })\n            );\n          } else {\n            setSearchParams(createSearchParams({ sort: id }));\n          }\n        }}\n        className={`sortable ${sort === id ? \"active\" : \"\"} ${\n          sort === id && sortReverse ? \"reverse\" : \"\"\n        }`}\n      >\n        {title}\n      </th>\n    );\n  }\n\n  const filteredDocuments = documents\n    .filter((document) => {\n      if (\n        filterTitle &&\n        !document.title.toLowerCase().includes(filterTitle.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterURL &&\n        !document.mdn_url.toLowerCase().includes(filterURL.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterDifferencesOperation &&\n        !matchNumericOperation(\n          document.differences.total,\n          filterDifferencesOperation\n        )\n      ) {\n        return false;\n      }\n\n      return true;\n    })\n    .sort((A, B) => {\n      let reverse = sortReverse ? -1 : 1;\n      if (sort === \"modified\") {\n        const a = new Date(A.edits.modified);\n        const b = new Date(B.edits.modified);\n        return reverse * (b.getTime() - a.getTime());\n      } else if (sort === \"popularity\") {\n        const a = A.popularity.value;\n        const b = B.popularity.value;\n        return reverse * (b - a);\n      } else if (sort === \"differences\") {\n        const a = A.differences.total;\n        const b = B.differences.total;\n        return reverse * (b - a);\n      } else if (sort === \"title\") {\n        const a = A.title;\n        const b = B.title;\n        return reverse * a.localeCompare(b);\n      } else if (sort === \"mdn_url\") {\n        const a = A.mdn_url;\n        const b = B.mdn_url;\n        return reverse * a.localeCompare(b);\n      } else {\n        throw new Error(`Unrecognized sort '${sort}'`);\n      }\n    });\n  const pageCount = Math.ceil(counts.found / pageSize);\n\n  return (\n    <div className=\"documents\">\n      <h3>\n        Documents found ({filteredDocuments.length.toLocaleString()}){\" \"}\n        {page > 1 && <span className=\"page\">page {page}</span>}{\" \"}\n        <small>of {counts.total.toLocaleString()} in total</small>\n      </h3>\n\n      {filterDifferences && !filterDifferencesOperation && (\n        <div className=\"error-message\">\n          <h3>Invalid differences filter</h3>\n          <p>\n            The <i>differences</i> filter can't be parsed.\n            <br />\n            <code>{filterDifferences}</code>\n          </p>\n        </div>\n      )}\n\n      <table>\n        <thead>\n          <tr>\n            <TableHead id=\"title\" title=\"Document\" />\n            <TableHead id=\"popularity\" title=\"Popularity\" />\n            <TableHead id=\"modified\" title=\"Last modified\" />\n            <TableHead id=\"differences\" title=\"Differences\" />\n          </tr>\n        </thead>\n        <tbody>\n          {filteredDocuments\n            .slice((page - 1) * pageSize, page * pageSize)\n            .map((doc: Document) => {\n              return (\n                <tr key={doc.mdn_url}>\n                  <td>\n                    <span className=\"document-title-preview\">\n                      {filterTitle ? (\n                        <HighlightedText\n                          text={doc.title}\n                          highlight={filterTitle}\n                        />\n                      ) : (\n                        doc.title\n                      )}\n                    </span>\n                    <br />\n                    <Link\n                      to={`${doc.mdn_url}#_flaws`}\n                      title={doc.title}\n                      target=\"_blank\"\n                    >\n                      <BriefURL uri={doc.mdn_url} filterURL={filterURL} />\n                    </Link>\n                  </td>\n                  <td\n                    title={\n                      doc.popularity.ranking\n                        ? `Meaning there are ${\n                            doc.popularity.ranking - 1\n                          } more popular pages than this`\n                        : \"Meaning it has no ranking. Most likely a very rare (or new) document\"\n                    }\n                  >\n                    {!doc.popularity.ranking\n                      ? \"n/a\"\n                      : `${getGetOrdinal(doc.popularity.ranking)}`}{\" \"}\n                    <small title=\"For the parent document\">\n                      (\n                      {!doc.popularity.parentRanking\n                        ? \"n/a\"\n                        : `${getGetOrdinal(doc.popularity.parentRanking)}`}\n                      )\n                    </small>\n                  </td>\n                  <td>\n                    <LastModified edits={doc.edits} />\n                  </td>\n                  <td>{doc.differences.total.toLocaleString()}</td>\n                </tr>\n              );\n            })}\n        </tbody>\n      </table>\n      {pageCount > 1 && (\n        <p className=\"pagination\">\n          <PageLink number={1} disabled={page === 1}>\n            First page\n          </PageLink>{\" \"}\n          {page > 2 && (\n            <PageLink number={page - 1}>Previous page ({page - 1})</PageLink>\n          )}{\" \"}\n          <PageLink number={page + 1} disabled={page + 1 > pageCount}>\n            Next page ({page + 1})\n          </PageLink>\n        </p>\n      )}\n    </div>\n  );\n}\n\nfunction LastModified({ edits }: { edits: DocumentEdits }) {\n  const modified = dayjs(edits.modified);\n  const parentModified = dayjs(edits.parentModified);\n  return (\n    <span\n      className={`last_modified ${\n        parentModified < modified ? \"ahead\" : \"behind\"\n      }`}\n    >\n      <a href={edits.commitURL} target=\"_blank\" rel=\"noreferrer\">\n        <time dateTime={modified.toISOString()} title={modified.toISOString()}>\n          {modified.fromNow()}\n        </time>\n      </a>\n      <br />\n      <a href={edits.parentCommitURL} target=\"_blank\" rel=\"noreferrer\">\n        <small>\n          <time\n            dateTime={parentModified.toISOString()}\n            title={parentModified.toISOString()}\n          >\n            en-US {parentModified.fromNow()}\n          </time>\n        </small>\n      </a>\n    </span>\n  );\n}\n\nfunction HighlightedText({\n  text,\n  highlight,\n}: {\n  text: string;\n  highlight: string;\n}) {\n  // Split on highlight term and include term into parts, ignore case\n  const parts = text.split(new RegExp(`(${highlight})`, \"gi\"));\n  return (\n    <span>\n      {\" \"}\n      {parts.map((part, i) => (\n        <span\n          key={i}\n          style={\n            part.toLowerCase() === highlight.toLowerCase()\n              ? { fontWeight: \"bold\" }\n              : {}\n          }\n        >\n          {part}\n        </span>\n      ))}{\" \"}\n    </span>\n  );\n}\n\nfunction BriefURL({ uri, filterURL }: { uri: string; filterURL: string }) {\n  const [left, right] = uri.split(/\\/docs\\//, 2);\n  return (\n    <>\n      <span className=\"url-prefix\">{left}/docs/</span>\n      <span className=\"url-slug\">\n        {filterURL ? (\n          <HighlightedText text={right} highlight={filterURL} />\n        ) : (\n          right\n        )}\n      </span>\n    </>\n  );\n}\n\n// https://gist.github.com/jlbruno/1535691/db35b4f3af3dcbb42babc01541410f291a8e8fac\nfunction getGetOrdinal(n: number) {\n  const s = [\"th\", \"st\", \"nd\", \"rd\"];\n  const v = n % 100;\n  return n.toLocaleString() + (s[(v - 20) % 10] || s[v] || s[0]);\n}\n\nfunction PageLink({\n  number,\n  disabled,\n  children,\n}: {\n  number: number;\n  disabled?: boolean;\n  children: React.ReactNode;\n}) {\n  const [searchParams] = useSearchParams();\n  const params = createSearchParams(searchParams);\n  if (number > 1) {\n    params.set(\"page\", `${number}`);\n  } else {\n    params.delete(\"page\");\n  }\n  return (\n    <Link\n      to={\"?\" + params.toString()}\n      className={disabled ? \"disabled\" : \"\"}\n      onClick={(event) => {\n        if (disabled) {\n          event.preventDefault();\n        }\n        const top = document.querySelector(\"div.all-translations\");\n        if (top) {\n          top.scrollIntoView({ behavior: \"smooth\" });\n        }\n      }}\n    >\n      {children}\n    </Link>\n  );\n}\n","import React from \"react\";\nimport {\n  createSearchParams,\n  Link,\n  useParams,\n  useSearchParams,\n  useNavigate,\n} from \"react-router-dom\";\nimport useSWR from \"swr\";\nimport dayjs from \"dayjs\";\nimport relativeTime from \"dayjs/plugin/relativeTime\";\n\nimport { PageContentContainer } from \"../../ui/atoms/page-content\";\n\ndayjs.extend(relativeTime);\n\ninterface DocumentPopularity {\n  value: number;\n  ranking: number;\n  parentValue: number;\n  parentRanking: number;\n}\n\ntype CountByType = { [key: string]: number };\n\ninterface DocumentDifferences {\n  countByType: CountByType;\n  total: number;\n}\n\ninterface DocumentEdits {\n  modified: string;\n  parentModified: string;\n  commitURL: string;\n  parentCommitURL: string;\n}\n\ninterface Document {\n  mdn_url: string;\n  edits: DocumentEdits;\n  title: string;\n  popularity: DocumentPopularity;\n  differences: DocumentDifferences;\n}\n\ninterface Counts {\n  missing: number;\n  translated: number;\n  total: number;\n  cacheMisses: number;\n}\n\ninterface Times {\n  took: number;\n}\n\ninterface FlawLevel {\n  name: string;\n  level: string;\n  ignored: boolean;\n}\n\ninterface Data {\n  counts: Counts;\n  missingDocuments: Document[];\n  times: Times;\n  flawLevels: FlawLevel[];\n}\n\ninterface LocaleStorageData {\n  lastLoadTime?: number;\n  defaultSort?: string;\n  defaultSortReverse?: string;\n}\n\ninterface StorageData {\n  [locale: string]: LocaleStorageData;\n}\n\nconst LOCALSTORAGE_KEY = \"translations-dashboard-missing\";\n\nfunction saveStorage(locale: string, data: LocaleStorageData) {\n  try {\n    const stored = JSON.parse(\n      localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\"\n    ) as StorageData;\n    stored[locale] = Object.assign({}, stored[locale] || {}, data);\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(stored));\n  } catch (err) {\n    console.warn(\"Unable to save to localStorage\", err);\n  }\n}\n\nfunction getStorage(locale: string): LocaleStorageData | null {\n  try {\n    const stored = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\");\n    if (stored) {\n      return stored[locale] as LocaleStorageData;\n    }\n  } catch (err) {\n    console.warn(\"Unable to retrieve from localStorage\", err);\n  }\n  return null;\n}\n\nexport function MissingTranslations() {\n  const { locale = \"en-US\" } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  const [lastData, setLastData] = React.useState<Data | null>(null);\n\n  React.useEffect(() => {\n    if (locale.toLowerCase() === \"en-us\") {\n      navigate(`/${locale}/_translations`);\n    }\n  }, [locale, navigate]);\n\n  React.useEffect(() => {\n    let title = \"Missing translations\";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    if (lastData) {\n      title = `(${lastData.counts.missing.toLocaleString()} found) ${title}`;\n    }\n    document.title = title;\n  }, [lastData, locale]);\n\n  const { data, error, isValidating } = useSWR<Data, Error>(\n    locale.toLowerCase() !== \"en-us\"\n      ? `/_translations/missing/?locale=${locale}`\n      : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      if (\n        !(response.headers.get(\"content-type\") || \"\").includes(\n          \"application/json\"\n        )\n      ) {\n        throw new Error(\n          `Response is not JSON (${response.headers.get(\"content-type\")})`\n        );\n      }\n      return response.json();\n    },\n    {\n      revalidateOnFocus: false,\n    }\n  );\n\n  // Use this to be able to figure out how long the XHR takes when there's no cache\n  const startTime = React.useRef<Date>();\n  React.useEffect(() => {\n    if (locale) {\n      if (!data) {\n        startTime.current = new Date();\n      } else {\n        if (\n          data.counts.cacheMisses > 0 &&\n          data.counts.cacheMisses === data.counts.total &&\n          startTime.current\n        ) {\n          const lastLoadTime =\n            new Date().getTime() - startTime.current.getTime();\n          saveStorage(locale, { lastLoadTime });\n        }\n      }\n    }\n  }, [locale, data]);\n\n  React.useEffect(() => {\n    if (data) {\n      setLastData(data);\n    }\n  }, [data]);\n\n  const lastStorageData = getStorage(locale);\n  const defaultSort = lastStorageData?.defaultSort || \"popularity\";\n  const defaultSortReverse = lastStorageData?.defaultSortReverse || \"false\";\n  const sort = searchParams.get(\"sort\") || defaultSort;\n  const sortReverse = JSON.parse(\n    searchParams.get(\"sortReverse\") || defaultSortReverse\n  );\n\n  React.useEffect(() => {\n    saveStorage(\n      locale,\n      Object.assign({}, lastStorageData, {\n        defaultSort: sort,\n        defaultSortReverse: sortReverse,\n      })\n    );\n  }, [locale, sort, sortReverse, lastStorageData]);\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return null;\n  }\n\n  return (\n    <Container>\n      {lastData && !error && isValidating && (\n        <p style={{ float: \"right\" }}>Reloading...</p>\n      )}\n      {!data && !error && !lastData && (\n        <Loading\n          estimate={\n            (lastStorageData && lastStorageData.lastLoadTime) || 30 * 1000\n          }\n        />\n      )}\n      {lastData && (\n        <p style={{ textAlign: \"right\" }}>\n          Go to{\" \"}\n          <Link to={`/${locale}/_translations/differences`}>\n            Translation differences for <b>{locale}</b>\n          </Link>\n        </p>\n      )}\n      {error && <ShowSearchError error={error} />}\n      {lastData && (\n        <div className=\"filter-documents\">\n          <FilterControls />\n          <DocumentsTable\n            counts={lastData.counts}\n            documents={lastData.missingDocuments}\n            sort={sort}\n            sortReverse={sortReverse}\n          />\n        </div>\n      )}\n      {data && <BuildTimes times={data.times} />}\n    </Container>\n  );\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"missing-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowSearchError({ error }) {\n  return (\n    <div className=\"error-message search-error\">\n      <h3>Search error</h3>\n      <pre>{error.toString()}</pre>\n    </div>\n  );\n}\n\nfunction BuildTimes({ times }: { times: Times }) {\n  function format(ms: number) {\n    if (ms > 1000) {\n      const s = ms / 1000;\n      return `${s.toFixed(1)} seconds`;\n    } else {\n      return `${Math.trunc(ms)} milliseconds`;\n    }\n  }\n  return (\n    <div className=\"search-times\">\n      <p>Time to find all documents {format(times.took)}</p>\n    </div>\n  );\n}\n\nfunction Loading({ estimate }: { estimate: number }) {\n  const startLoadingTime = new Date();\n  const [estimateEndTime] = React.useState(\n    new Date(startLoadingTime.getTime() + estimate)\n  );\n\n  const [, setIncrements] = React.useState(0);\n  React.useEffect(() => {\n    const interval = setInterval(() => {\n      setIncrements((state) => state + 1);\n    }, 1000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const distance = estimateEndTime.getTime() - startLoadingTime.getTime();\n  const elapsed = new Date().getTime() - startLoadingTime.getTime();\n  const percent = (100 * elapsed) / distance;\n  return (\n    <div className=\"loading\">\n      <progress id=\"progress\" max=\"100\" value={percent} style={{ margin: 20 }}>\n        {percent}%\n      </progress>\n      <br />\n      <small>\n        Estimated time to finish: {((distance - elapsed) / 1000).toFixed(0)}s{\" \"}\n        {elapsed > distance ? (\n          <span aria-label=\"weird\" role=\"img\">\n            🙃\n          </span>\n        ) : null}\n      </small>\n    </div>\n  );\n}\n\nfunction FilterControls() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [title, setTitle] = React.useState(searchParams.get(\"title\") || \"\");\n  const [url, setURL] = React.useState(searchParams.get(\"url\") || \"\");\n\n  function refreshFilters(reset = false) {\n    const filterParams = createSearchParams(searchParams);\n    for (const [key, value] of [\n      [\"url\", url],\n      [\"title\", title],\n    ]) {\n      if (!reset && value) {\n        filterParams.set(key, value);\n      } else {\n        filterParams.delete(key);\n      }\n    }\n    filterParams.delete(\"page\");\n    setSearchParams(filterParams);\n  }\n\n  function resetFilters() {\n    setURL(\"\");\n    setTitle(\"\");\n    refreshFilters(true);\n  }\n\n  return (\n    <div className=\"filters\">\n      <h3>Filters</h3>\n      <form\n        onSubmit={(event) => {\n          event.preventDefault();\n          refreshFilters();\n        }}\n      >\n        <div>\n          <h4>Document</h4>\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document URI\"\n            value={url}\n            onChange={(event) => {\n              setURL(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n          <input\n            type=\"search\"\n            placeholder=\"Filter by document title\"\n            value={title}\n            onChange={(event) => {\n              setTitle(event.target.value);\n            }}\n            onBlur={() => refreshFilters()}\n          />\n        </div>\n\n        <div>\n          <h4>&nbsp;</h4>\n          <button type=\"submit\">Filter now</button>{\" \"}\n          {(url || title) && (\n            <button type=\"button\" onClick={resetFilters}>\n              Reset filters\n            </button>\n          )}\n        </div>\n      </form>\n    </div>\n  );\n}\ntype NumericOperation = {\n  operation: \"eq\" | \"gt\" | \"gte\" | \"lt\" | \"lte\";\n  value: number;\n};\n\nfunction getNumericOperation(expression: string): NumericOperation | null {\n  function parseIntOrThrow(v: string) {\n    if (!v) {\n      throw new Error(\"Can't be empty\");\n    }\n\n    const parsed = parseInt(v, 10);\n    if (isNaN(parsed)) {\n      throw new Error(`'${v}' not a valid number`);\n    }\n    return parsed;\n  }\n  try {\n    if (expression.startsWith(\">=\")) {\n      return {\n        operation: \"gte\",\n        value: parseIntOrThrow(expression.replace(\">=\", \"\")),\n      };\n    } else if (expression.startsWith(\">\")) {\n      return {\n        operation: \"gt\",\n        value: parseIntOrThrow(expression.replace(\">\", \"\")),\n      };\n    } else if (expression.startsWith(\"<=\")) {\n      return {\n        operation: \"lte\",\n        value: parseIntOrThrow(expression.replace(\"<=\", \"\")),\n      };\n    } else if (expression.startsWith(\"<\")) {\n      return {\n        operation: \"lt\",\n        value: parseIntOrThrow(expression.replace(\"<\", \"\")),\n      };\n    } else if (expression.startsWith(\"==\") || expression.startsWith(\"=\")) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression.replace(/=/g, \"\")),\n      };\n    } else if (expression) {\n      return {\n        operation: \"eq\",\n        value: parseIntOrThrow(expression),\n      };\n    } else {\n      return null;\n    }\n  } catch (error) {\n    console.warn(error);\n    return null;\n  }\n}\n\nfunction matchNumericOperation(value: number, op: NumericOperation): boolean {\n  if (op.operation === \"eq\") {\n    if (value !== op.value) {\n      return false;\n    }\n  } else if (op.operation === \"gt\") {\n    if (!(value > op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"gte\") {\n    if (!(value >= op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lt\") {\n    if (!(value < op.value)) {\n      return false;\n    }\n  } else if (op.operation === \"lte\") {\n    if (!(value <= op.value)) {\n      return false;\n    }\n  } else {\n    throw new Error(`Not implemented operation '${op.operation}'`);\n  }\n  return true;\n}\n\nfunction DocumentsTable({\n  counts,\n  documents,\n  sort,\n  sortReverse,\n}: {\n  counts: Counts;\n  documents: Document[];\n  sort: string;\n  sortReverse: boolean;\n}) {\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  const page = parseInt(searchParams.get(\"page\") || \"1\", 10);\n  const pageSize = parseInt(searchParams.get(\"pageSize\") || \"20\", 10);\n  const filterTitle = searchParams.get(\"title\") || \"\";\n  const filterURL = searchParams.get(\"url\") || \"\";\n  const filterDifferences = searchParams.get(\"differences\") || \"\";\n  const filterDifferencesOperation = getNumericOperation(filterDifferences);\n\n  function TableHead({ id, title }: { id: string; title: string }) {\n    return (\n      <th\n        onClick={() => {\n          if (sort === id) {\n            setSearchParams(\n              createSearchParams({\n                sort: id,\n                sortReverse: JSON.stringify(!sortReverse),\n              })\n            );\n          } else {\n            setSearchParams(createSearchParams({ sort: id }));\n          }\n        }}\n        className={`sortable ${sort === id ? \"active\" : \"\"} ${\n          sort === id && sortReverse ? \"reverse\" : \"\"\n        }`}\n      >\n        {title}\n      </th>\n    );\n  }\n\n  const filteredDocuments = documents\n    .filter((document) => {\n      if (\n        filterTitle &&\n        !document.title.toLowerCase().includes(filterTitle.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterURL &&\n        !document.mdn_url.toLowerCase().includes(filterURL.toLowerCase())\n      ) {\n        return false;\n      }\n\n      if (\n        filterDifferencesOperation &&\n        !matchNumericOperation(\n          document.differences.total,\n          filterDifferencesOperation\n        )\n      ) {\n        return false;\n      }\n\n      return true;\n    })\n    .sort((A, B) => {\n      let reverse = sortReverse ? -1 : 1;\n      if (sort === \"modified\") {\n        const a = new Date(A.edits.modified);\n        const b = new Date(B.edits.modified);\n        return reverse * (b.getTime() - a.getTime());\n      } else if (sort === \"popularity\") {\n        const a = A.popularity.value;\n        const b = B.popularity.value;\n        return reverse * (b - a);\n      } else if (sort === \"differences\") {\n        const a = A.differences.total;\n        const b = B.differences.total;\n        return reverse * (b - a);\n      } else if (sort === \"title\") {\n        const a = A.title;\n        const b = B.title;\n        return reverse * a.localeCompare(b);\n      } else if (sort === \"mdn_url\") {\n        const a = A.mdn_url;\n        const b = B.mdn_url;\n        return reverse * a.localeCompare(b);\n      } else {\n        throw new Error(`Unrecognized sort '${sort}'`);\n      }\n    });\n  const pageCount = Math.ceil(counts.total / pageSize);\n\n  return (\n    <div className=\"documents\">\n      <h3>\n        {counts.missing.toLocaleString()} missing translations (of{\" \"}\n        {counts.total.toLocaleString()} possible)\n      </h3>\n\n      <table>\n        <thead>\n          <tr>\n            <TableHead id=\"title\" title=\"Document\" />\n            <TableHead id=\"popularity\" title=\"Popularity\" />\n            <TableHead id=\"modified\" title=\"Last modified\" />\n          </tr>\n        </thead>\n        <tbody>\n          {filteredDocuments\n            .slice((page - 1) * pageSize, page * pageSize)\n            .map((doc: Document) => {\n              return (\n                <tr key={doc.mdn_url}>\n                  <td>\n                    <span className=\"document-title-preview\">\n                      {filterTitle ? (\n                        <HighlightedText\n                          text={doc.title}\n                          highlight={filterTitle}\n                        />\n                      ) : (\n                        doc.title\n                      )}\n                    </span>\n                    <br />\n                    <Link\n                      to={`${doc.mdn_url}#_flaws`}\n                      title={doc.title}\n                      target=\"_blank\"\n                    >\n                      <BriefURL uri={doc.mdn_url} filterURL={filterURL} />\n                    </Link>\n                  </td>\n                  <td\n                    title={\n                      doc.popularity.ranking\n                        ? `Meaning there are ${\n                            doc.popularity.ranking - 1\n                          } more popular pages than this`\n                        : \"Meaning it has no ranking. Most likely a very rare (or new) document\"\n                    }\n                  >\n                    {!doc.popularity.ranking\n                      ? \"n/a\"\n                      : `${getGetOrdinal(doc.popularity.ranking)}`}{\" \"}\n                  </td>\n                  <td>\n                    <LastModified edits={doc.edits} />\n                  </td>\n                </tr>\n              );\n            })}\n        </tbody>\n      </table>\n      {pageCount > 1 && (\n        <p className=\"pagination\">\n          <PageLink number={1} disabled={page === 1}>\n            First page\n          </PageLink>{\" \"}\n          {page > 2 && (\n            <PageLink number={page - 1}>Previous page ({page - 1})</PageLink>\n          )}{\" \"}\n          <PageLink number={page + 1} disabled={page + 1 > pageCount}>\n            Next page ({page + 1})\n          </PageLink>\n        </p>\n      )}\n    </div>\n  );\n}\n\nfunction LastModified({ edits }: { edits: DocumentEdits }) {\n  const modified = dayjs(edits.modified);\n  return (\n    <span className=\"last_modified\">\n      <a href={edits.commitURL} target=\"_blank\" rel=\"noreferrer\">\n        <time dateTime={modified.toISOString()} title={modified.toISOString()}>\n          {modified.fromNow()}\n        </time>\n      </a>\n    </span>\n  );\n}\n\nfunction HighlightedText({\n  text,\n  highlight,\n}: {\n  text: string;\n  highlight: string;\n}) {\n  // Split on highlight term and include term into parts, ignore case\n  const parts = text.split(new RegExp(`(${highlight})`, \"gi\"));\n  return (\n    <span>\n      {\" \"}\n      {parts.map((part, i) => (\n        <span\n          key={i}\n          style={\n            part.toLowerCase() === highlight.toLowerCase()\n              ? { fontWeight: \"bold\" }\n              : {}\n          }\n        >\n          {part}\n        </span>\n      ))}{\" \"}\n    </span>\n  );\n}\n\nfunction BriefURL({ uri, filterURL }: { uri: string; filterURL: string }) {\n  const [left, right] = uri.split(/\\/docs\\//, 2);\n  return (\n    <>\n      <span className=\"url-prefix\">{left}/docs/</span>\n      <span className=\"url-slug\">\n        {filterURL ? (\n          <HighlightedText text={right} highlight={filterURL} />\n        ) : (\n          right\n        )}\n      </span>\n    </>\n  );\n}\n\n// https://gist.github.com/jlbruno/1535691/db35b4f3af3dcbb42babc01541410f291a8e8fac\nfunction getGetOrdinal(n: number) {\n  const s = [\"th\", \"st\", \"nd\", \"rd\"];\n  const v = n % 100;\n  return n.toLocaleString() + (s[(v - 20) % 10] || s[v] || s[0]);\n}\n\nfunction PageLink({\n  number,\n  disabled,\n  children,\n}: {\n  number: number;\n  disabled?: boolean;\n  children: React.ReactNode;\n}) {\n  const [searchParams] = useSearchParams();\n  const params = createSearchParams(searchParams);\n  if (number > 1) {\n    params.set(\"page\", `${number}`);\n  } else {\n    params.delete(\"page\");\n  }\n  return (\n    <Link\n      to={\"?\" + params.toString()}\n      className={disabled ? \"disabled\" : \"\"}\n      onClick={(event) => {\n        if (disabled) {\n          event.preventDefault();\n        }\n        const top = document.querySelector(\"div.all-translations\");\n        if (top) {\n          top.scrollIntoView({ behavior: \"smooth\" });\n        }\n      }}\n    >\n      {children}\n    </Link>\n  );\n}\n","import React from \"react\";\nimport {\n  createSearchParams,\n  Link,\n  useParams,\n  useSearchParams,\n  useNavigate,\n} from \"react-router-dom\";\nimport useSWR from \"swr\";\n\nimport { PageContentContainer } from \"../../ui/atoms/page-content\";\n\ninterface Data {\n  l10nKPIs: L10nKPIs;\n  sections: Section[];\n  detailDocuments: DetailDocument[];\n}\n\ninterface Section {\n  l10nKPIs: L10nKPIs;\n  name: string;\n}\n\ninterface L10nKPIs {\n  missing: number;\n  outOfDate: number;\n  upToDate: number;\n  total: number;\n}\n\ninterface DetailDocument {\n  url: string;\n  info: InfoDocument;\n}\n\ninterface InfoDocument {\n  popularity: DocumentPopularity;\n  localePopularity: DocumentPopularity;\n  defaultLocaleInfo: LocaleInfo;\n  localeInfo?: LocaleInfo;\n  dateDiff?: number;\n}\n\ninterface DocumentPopularity {\n  value: number;\n  ranking: number;\n  parentValue: number;\n  parentRanking: number;\n}\n\ninterface LocaleInfo {\n  modified: string;\n  commitURL: string;\n}\n\ninterface LocaleStorageData {\n  defaultSort?: string;\n  defaultSortReverse?: string;\n}\n\ninterface StorageData {\n  [locale: string]: LocaleStorageData;\n}\n\nconst LOCALSTORAGE_KEY = \"translations-dashboard-sections\";\n\nfunction saveStorage(locale: string, data: LocaleStorageData) {\n  try {\n    const stored = JSON.parse(\n      localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\"\n    ) as StorageData;\n    stored[locale] = Object.assign({}, stored[locale] || {}, data);\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(stored));\n  } catch (err) {\n    console.warn(\"Unable to save to localStorage\", err);\n  }\n}\n\nfunction getStorage(locale: string): LocaleStorageData | null {\n  try {\n    const stored = JSON.parse(localStorage.getItem(LOCALSTORAGE_KEY) || \"{}\");\n    if (stored) {\n      return stored[locale] as LocaleStorageData;\n    }\n  } catch (err) {\n    console.warn(\"Unable to retrieve from localStorage\", err);\n  }\n  return null;\n}\n\nexport function TranslationDashboard() {\n  const { locale = \"en-US\" } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n\n  const [lastData, setLastData] = React.useState<Data | null>(null);\n\n  const currentSection = searchParams.get(\"section\") || \"\";\n  React.useEffect(() => {\n    if (locale.toLowerCase() === \"en-us\") {\n      navigate(`/${locale}/_translations`);\n    }\n  }, [locale, navigate]);\n\n  React.useEffect(() => {\n    let title = \"Translation dashboard \";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    if (currentSection !== \"\") {\n      title += ` - section ${currentSection}`;\n    }\n    document.title = title;\n  }, [lastData, locale, currentSection]);\n\n  let { data, error, isValidating } = useSWR<Data, Error>(\n    locale.toLowerCase() !== \"en-us\"\n      ? `/_translations/dashboard/?locale=${locale}&section=${currentSection}`\n      : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      if (\n        !(response.headers.get(\"content-type\") || \"\").includes(\n          \"application/json\"\n        )\n      ) {\n        throw new Error(\n          `Response is not JSON (${response.headers.get(\"content-type\")})`\n        );\n      }\n      return response.json();\n    },\n    {\n      revalidateOnFocus: false,\n    }\n  );\n\n  React.useEffect(() => {\n    if (data) {\n      setLastData(data);\n    }\n  }, [data]);\n\n  const lastStorageData = getStorage(locale);\n  const defaultSort = lastStorageData?.defaultSort || \"url\";\n  const defaultSortReverse = lastStorageData?.defaultSortReverse || \"false\";\n  const sort = searchParams.get(\"sort\") || defaultSort;\n  const sortReverse = JSON.parse(\n    searchParams.get(\"sortReverse\") || defaultSortReverse\n  );\n\n  React.useEffect(() => {\n    saveStorage(\n      locale,\n      Object.assign({}, lastStorageData, {\n        defaultSort: sort,\n        defaultSortReverse: sortReverse,\n      })\n    );\n  }, [locale, sort, sortReverse, lastStorageData]);\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return null;\n  }\n\n  let parentSection = \"/\";\n  if (currentSection.split(\"/\").length > 2) {\n    const arrPathSection = currentSection.split(\"/\");\n    arrPathSection.pop();\n    parentSection = arrPathSection.join(\"/\");\n  }\n\n  return (\n    <Container>\n      {lastData && !error && isValidating && (\n        <p style={{ float: \"right\" }}>Reloading...</p>\n      )}\n      {!data && !error && !lastData && <Loading />}\n      {lastData && (\n        <p style={{ textAlign: \"right\" }}>\n          Go to{\" \"}\n          <Link to={`/${locale}/_translations/differences`}>\n            Translation differences for <b>{locale}</b>\n          </Link>\n          {\" / \"}\n          <Link to={`/${locale}/_translations/missing`}>\n            Missing translations for <b>{locale}</b>\n          </Link>\n        </p>\n      )}\n      {error && <ShowError error={error} />}\n      {lastData && (\n        <div className=\"filter-documents\">\n          <SectionHeader\n            l10nKPIs={lastData.l10nKPIs}\n            section={currentSection}\n            parentSection={parentSection}\n          />\n          <SubsectionTable\n            sections={lastData.sections}\n            currentSection={currentSection}\n          />\n          <DocumentsTable\n            documents={lastData.detailDocuments}\n            sort={sort}\n            sortReverse={sortReverse}\n            locale={locale}\n          />\n        </div>\n      )}\n    </Container>\n  );\n  /* \n     );\n    }\n */\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"dashboard-section-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowError({ error }) {\n  return (\n    <div className=\"error-message\">\n      <h3>Error</h3>\n      <pre>{error.toString()}</pre>\n    </div>\n  );\n}\n\nfunction Loading() {\n  return (\n    <div>\n      <label htmlFor=\"progress\">Loading</label>\n      <progress id=\"progress\" max=\"100\" style={{ margin: 20 }}></progress>\n    </div>\n  );\n}\n\nfunction SectionHeader({\n  l10nKPIs,\n  section,\n  parentSection,\n}: {\n  l10nKPIs: L10nKPIs;\n  section: string;\n  parentSection: string;\n}) {\n  const completenessExact =\n    (100 * (l10nKPIs.total - l10nKPIs.missing)) / l10nKPIs.total;\n  const completenessStr = completenessExact.toFixed(1) + \"%\";\n  const freshnessExact = (100 * l10nKPIs.upToDate) / l10nKPIs.total;\n  const freshnessStr = freshnessExact.toFixed(1) + \"%\";\n  return (\n    <div className=\"documents\">\n      <h2>Localization dashboard for: {section || \"/\"}</h2>\n      <p>\n        Parent section:{\" \"}\n        <a href={`dashboard?section=${parentSection}`}>{parentSection}</a>\n      </p>\n      <h3>Summary</h3>\n      <dl>\n        <dt>Total number of pages</dt>\n        <dd>{l10nKPIs.total}</dd>\n        <dt>Number of untranslated pages</dt>\n        <dd>{l10nKPIs.missing}</dd>\n        <dt>Number of outdated pages (older than English in Git) </dt>\n        <dd>{l10nKPIs.outOfDate}</dd>\n        <dt>Number of up-to-date pages</dt>\n        <dd>{l10nKPIs.upToDate}</dd>\n        <dt>\n          <label htmlFor=\"completeness\">Localization completeness</label>\n        </dt>\n        <dd>\n          <progress id=\"completeness\" max=\"100\" value={completenessExact}>\n            {completenessStr}\n          </progress>{\" \"}\n          {completenessStr}\n        </dd>\n        <dt>\n          <label htmlFor=\"freshness\">Localization freshness</label>\n        </dt>\n        <dd>\n          <progress id=\"freshness\" max=\"100\" value={freshnessExact}>\n            {freshnessStr}\n          </progress>{\" \"}\n          {freshnessStr}\n        </dd>\n      </dl>\n    </div>\n  );\n}\n\nfunction SubsectionTable({\n  sections,\n  currentSection,\n}: {\n  sections: Section[];\n  currentSection: string;\n}) {\n  if (sections.length > 0) {\n    return (\n      <section id=\"subsection-table\">\n        <h3>Subsections</h3>\n        <table>\n          <thead>\n            <tr>\n              <th>Section</th>\n              <th>Total / Untranslated / Out of date</th>\n              <th>Completeness</th>\n              <th>Freshness</th>\n            </tr>\n          </thead>\n          <tbody>\n            {sections\n              .sort(\n                (sectionA, sectionB) =>\n                  sectionB.l10nKPIs.total - sectionA.l10nKPIs.total\n              )\n              .map((section) => {\n                const completenessExact =\n                  (100 * (section.l10nKPIs.total - section.l10nKPIs.missing)) /\n                  section.l10nKPIs.total;\n                const completenessStr = completenessExact.toFixed(1) + \"%\";\n                const freshnessExact =\n                  (100 * section.l10nKPIs.upToDate) / section.l10nKPIs.total;\n                const freshnessStr = freshnessExact.toFixed(1) + \"%\";\n                const sectionHref =\n                  \"dashboard?section=%2F\" + encodeURIComponent(section.name);\n                return (\n                  <tr key={section.name}>\n                    <td>\n                      <a href={sectionHref}>\n                        {section.name\n                          .replace(currentSection.slice(1), \"\")\n                          .replace(\"/\", \"\")}\n                      </a>\n                    </td>\n                    <td>\n                      {section.l10nKPIs.total} / {section.l10nKPIs.missing} /{\" \"}\n                      {section.l10nKPIs.outOfDate}\n                    </td>\n                    <td>\n                      <progress max=\"100\" value={completenessExact}>\n                        {completenessStr}\n                      </progress>{\" \"}\n                      {completenessStr}\n                    </td>\n                    <td>\n                      <progress max=\"100\" value={freshnessExact}>\n                        {freshnessStr}\n                      </progress>{\" \"}\n                      {freshnessStr}\n                    </td>\n                  </tr>\n                );\n              })}\n          </tbody>\n        </table>\n      </section>\n    );\n  } else {\n    return null;\n  }\n}\n\nfunction DocumentsTable({\n  documents,\n  sort,\n  sortReverse,\n  locale,\n}: {\n  documents: DetailDocument[];\n  sort: string;\n  sortReverse: boolean;\n  locale: string;\n}) {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const currentSection = searchParams.get(\"section\") || \"\";\n  documents.map((documentDetail) => {\n    if (documentDetail.info.localeInfo) {\n      const dateLocale = new Date(documentDetail.info.localeInfo.modified);\n      const dateDefaultLocale = new Date(\n        documentDetail.info.defaultLocaleInfo.modified\n      );\n      const dateDiff = dateLocale.getTime() - dateDefaultLocale.getTime();\n      documentDetail.info.dateDiff = dateDiff;\n    } else {\n      documentDetail.info.dateDiff = Number.POSITIVE_INFINITY;\n    }\n    return documentDetail;\n  });\n\n  function TableHead({ id, title }: { id: string; title: string }) {\n    return (\n      <th\n        onClick={() => {\n          if (sort === id) {\n            setSearchParams(\n              createSearchParams({\n                sort: id,\n                sortReverse: JSON.stringify(!sortReverse),\n                section: currentSection,\n              })\n            );\n          } else {\n            setSearchParams(\n              createSearchParams({ sort: id, section: currentSection })\n            );\n          }\n        }}\n        className={`sortable ${sort === id ? \"active\" : \"\"} ${\n          sort === id && sortReverse ? \"reverse\" : \"\"\n        }`}\n      >\n        {title}\n      </th>\n    );\n  }\n\n  return (\n    <section id=\"documents-table\">\n      <h3>List of direct subpages</h3>\n      <table>\n        <thead>\n          <tr>\n            <TableHead id=\"url\" title=\"Slug\" />\n            <TableHead id=\"enMDNURL\" title=\"English doc on MDN\" />\n            <TableHead\n              id=\"enCommitGHURL\"\n              title=\"English doc commit on GitHub\"\n            />\n            <TableHead id=\"localURL\" title=\"Local localized doc\" />\n            <TableHead id=\"localMDNURL\" title=\"Localized doc on MDN\" />\n            <TableHead\n              id=\"localCommitGHURL\"\n              title=\"Localized doc commit on GitHub\"\n            />\n            <TableHead id=\"popularityEn\" title=\"Popularity rank (en-US)\" />\n            <TableHead\n              id=\"popularityLocale\"\n              title=\"Popularity rank ({locale})\"\n            />\n            <TableHead id=\"dateDiff\" title=\"Date delta\" />\n          </tr>\n        </thead>\n        <tbody>\n          {documents\n            .sort((A, B) => {\n              let reverse = sortReverse ? -1 : 1;\n              if (sort === \"dateDiff\") {\n                const a = A.info.dateDiff || Number.POSITIVE_INFINITY;\n                const b = B.info.dateDiff || Number.POSITIVE_INFINITY;\n                return reverse * (b - a);\n              } else if (sort === \"popularityLocale\") {\n                const a =\n                  A.info.localePopularity?.ranking || Number.POSITIVE_INFINITY;\n                const b =\n                  B.info.localePopularity?.ranking || Number.POSITIVE_INFINITY;\n                return reverse * (a - b);\n              } else if (sort === \"popularityEn\") {\n                const a = A.info.popularity.ranking || Number.POSITIVE_INFINITY;\n                const b = B.info.popularity.ranking || Number.POSITIVE_INFINITY;\n                return reverse * (a - b);\n              } else if (sort === \"url\") {\n                const a = A.url;\n                const b = B.url;\n                return reverse * a.localeCompare(b);\n              } else {\n                throw new Error(`Unrecognized sort '${sort}'`);\n              }\n            })\n            .map((documentDetail) => {\n              const url = \"https://developer.mozilla.org\" + documentDetail.url;\n              const englishCommitHash =\n                documentDetail.info.defaultLocaleInfo.commitURL\n                  .split(\"commit/\")[1]\n                  .substring(0, 7);\n              const localeCommitHash = documentDetail.info.localeInfo?.commitURL\n                .split(\"commit/\")[1]\n                .substring(0, 7);\n              let status = \"Untranslated\";\n              if (documentDetail.info.localeInfo) {\n                let dateDiff =\n                  documentDetail.info.dateDiff ?? Number.POSITIVE_INFINITY;\n                status = \"Out of date\";\n\n                if (dateDiff > 0) {\n                  status = \"Fresher than English\";\n                } else if (dateDiff > -2678400000) {\n                  const nbDays = Math.round(-dateDiff / (3600 * 24 * 1000));\n                  status = nbDays + \" day\" + (nbDays > 1 ? \"s\" : \"\");\n                } else {\n                  const nbMonths = Math.round(\n                    -dateDiff / (3600 * 24 * 1000 * 30)\n                  );\n                  status = nbMonths + \" month\" + (nbMonths > 1 ? \"s\" : \"\");\n                }\n              }\n              return (\n                <tr key={documentDetail.url}>\n                  <td>\n                    <a href={documentDetail.url}>{documentDetail.url}</a>\n                  </td>\n                  <td>\n                    <a href={url}>English current MDN page</a>\n                  </td>\n                  <td>\n                    <a href={documentDetail.info.defaultLocaleInfo.commitURL}>\n                      GitHub link for <code>{englishCommitHash}</code>\n                    </a>\n                  </td>\n                  <td>\n                    {documentDetail.info.localeInfo && (\n                      <a\n                        href={documentDetail.url.replace(\n                          \"/en-US/\",\n                          \"/\" + locale + \"/\"\n                        )}\n                      >\n                        Local {locale} page\n                      </a>\n                    )}\n                  </td>\n                  <td>\n                    {documentDetail.info.localeInfo && (\n                      <a href={url.replace(\"/en-US/\", \"/\" + locale + \"/\")}>\n                        Locale current MDN page\n                      </a>\n                    )}\n                  </td>\n                  <td>\n                    {documentDetail.info.localeInfo && (\n                      <a href={documentDetail.info.localeInfo.commitURL}>\n                        GitHub link for <code>{localeCommitHash}</code>\n                      </a>\n                    )}\n                  </td>\n                  <td>{documentDetail.info.popularity.ranking}</td>\n                  <td>\n                    {documentDetail.info.localePopularity &&\n                      documentDetail.info.localePopularity.ranking}\n                  </td>\n                  <td>{status}</td>\n                </tr>\n              );\n            })}\n        </tbody>\n      </table>\n    </section>\n  );\n}\n","import React from \"react\";\nimport { Link, useParams, Routes, Route } from \"react-router-dom\";\nimport useSWR from \"swr\";\n\nimport \"./index.scss\";\n\nimport { Loading } from \"../ui/atoms/loading\";\nimport { PageContentContainer } from \"../ui/atoms/page-content\";\n\nimport { TranslationDifferences } from \"./differences\";\nimport { MissingTranslations } from \"./missing\";\nimport { TranslationDashboard } from \"./dashboard\";\n\ninterface Locale {\n  locale: string;\n  language: {\n    English: string;\n    native: string;\n  };\n  isActive: boolean;\n  count: number;\n}\n\ninterface LocalesData {\n  locales: Locale[];\n}\n\nexport default function Translations() {\n  return (\n    <Container>\n      <Routes>\n        <Route path=\"/\" element={<PickLocale />} />\n        <Route path=\"differences\" element={<TranslationDifferences />} />\n        <Route path=\"missing\" element={<MissingTranslations />} />\n        <Route path=\"dashboard\" element={<TranslationDashboard />} />\n      </Routes>\n    </Container>\n  );\n}\n\nfunction PickLocale() {\n  const { locale = \"en-US\" } = useParams();\n  React.useEffect(() => {\n    let title = \"All translations\";\n    if (locale.toLowerCase() !== \"en-us\") {\n      title += ` for ${locale}`;\n    }\n    document.title = title;\n  }, [locale]);\n\n  const { data: dataLocales, error: errorLocales } = useSWR<LocalesData, Error>(\n    locale.toLowerCase() === \"en-us\" ? \"/_translations/\" : null,\n    async (url) => {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`${response.status} (${await response.text()})`);\n      }\n      return response.json();\n    }\n  );\n\n  if (locale.toLowerCase() === \"en-us\") {\n    return (\n      <>\n        {!dataLocales && !errorLocales && <Loading />}\n        {errorLocales && (\n          <div className=\"error-message\">\n            <h3>Server error</h3>\n            <pre>{errorLocales.toString()}</pre>\n          </div>\n        )}\n        {dataLocales && <ShowLocales locales={dataLocales.locales} />}\n      </>\n    );\n  }\n\n  return (\n    <div className=\"translation-choices\">\n      <Link to={`/${locale}/_translations/differences`} className=\"button\">\n        Translation differences\n      </Link>{\" \"}\n      <Link to={`/${locale}/_translations/missing`} className=\"button\">\n        Missing translations\n      </Link>{\" \"}\n      <Link to={`/${locale}/_translations/dashboard`} className=\"button\">\n        Dashboard\n      </Link>\n    </div>\n  );\n}\n\nfunction Container({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"all-translations\">\n      <PageContentContainer>{children}</PageContentContainer>\n    </div>\n  );\n}\n\nfunction ShowLocales({ locales }: { locales: Locale[] }) {\n  return (\n    <div>\n      <h2>Select locale</h2>\n      <table>\n        <tbody>\n          {locales.map((locale) => {\n            return (\n              <tr key={locale.locale}>\n                <td>\n                  <b>\n                    {locale.language.English} ({locale.locale})\n                  </b>{\" \"}\n                  {!locale.isActive && <small>not active</small>}\n                </td>\n                <td>{locale.count.toLocaleString()} documents</td>\n                <td>\n                  <Link to={`/${locale.locale}/_translations/differences`}>\n                    Translation differences\n                  </Link>{\" \"}\n                </td>\n                <td>\n                  <Link to={`/${locale.locale}/_translations/missing`}>\n                    Missing translations\n                  </Link>{\" \"}\n                </td>\n                <td>\n                  <Link to={`/${locale.locale}/_translations/dashboard`}>\n                    Dashboard\n                  </Link>{\" \"}\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n"],"names":["dayjs","relativeTime","LOCALSTORAGE_KEY","saveStorage","locale","data","stored","JSON","parse","localStorage","getItem","Object","assign","setItem","stringify","err","console","warn","TranslationDifferences","useParams","useSearchParams","searchParams","navigate","useNavigate","React","lastData","setLastData","toLowerCase","title","counts","found","toLocaleString","document","useSWR","url","fetch","response","ok","Error","status","text","headers","get","includes","json","revalidateOnFocus","error","isValidating","startTime","cacheMisses","total","current","lastLoadTime","Date","getTime","lastStorageData","getStorage","defaultSort","defaultSortReverse","sort","sortReverse","Container","style","float","Loading","estimate","textAlign","to","ShowSearchError","className","FilterControls","DocumentsTable","documents","BuildTimes","times","children","toString","ms","took","toFixed","Math","trunc","startLoadingTime","estimateEndTime","setIncrements","interval","setInterval","state","clearInterval","distance","elapsed","percent","id","max","value","margin","role","setSearchParams","setTitle","setURL","differences","setDifferences","refreshFilters","reset","filterParams","createSearchParams","key","set","delete","onSubmit","event","preventDefault","type","placeholder","onChange","target","onBlur","onClick","page","parseInt","pageSize","filterTitle","filterURL","filterDifferences","filterDifferencesOperation","expression","parseIntOrThrow","v","parsed","isNaN","startsWith","operation","replace","getNumericOperation","TableHead","filteredDocuments","filter","mdn_url","op","matchNumericOperation","A","B","reverse","a","edits","modified","popularity","b","localeCompare","pageCount","ceil","length","slice","map","doc","HighlightedText","highlight","BriefURL","uri","ranking","getGetOrdinal","parentRanking","LastModified","PageLink","number","disabled","parentModified","href","commitURL","rel","dateTime","toISOString","fromNow","parentCommitURL","parts","split","RegExp","part","i","fontWeight","left","right","n","s","params","top","querySelector","scrollIntoView","behavior","MissingTranslations","missing","missingDocuments","TranslationDashboard","currentSection","parentSection","arrPathSection","pop","join","ShowError","SectionHeader","l10nKPIs","section","SubsectionTable","sections","detailDocuments","htmlFor","completenessExact","completenessStr","freshnessExact","upToDate","freshnessStr","outOfDate","sectionA","sectionB","sectionHref","encodeURIComponent","name","documentDetail","info","localeInfo","dateLocale","dateDefaultLocale","defaultLocaleInfo","dateDiff","Number","POSITIVE_INFINITY","localePopularity","englishCommitHash","substring","localeCommitHash","nbDays","round","nbMonths","Translations","path","element","PickLocale","dataLocales","errorLocales","ShowLocales","locales","language","English","isActive","count"],"sourceRoot":""}