{"version":3,"file":"static/js/472.c8fa94b7.chunk.js","mappings":"kOAEA,SAASA,IACP,OAAQC,SAASC,O,cCcJ,SAASC,IACtB,IAAMC,EDZD,WACL,MAAkCC,EAAAA,SAAeL,KAAjD,eAAOI,EAAP,KAAkBE,EAAlB,KACMC,EAAqB,kBAAMD,EAAaN,MAQ9C,OAPAQ,EAAAA,EAAAA,YAAU,WACR,IAAMC,EAAmB,mBAEzB,OADAR,SAASS,iBAAiBD,EAAkBF,GAAoB,GACzD,WACLN,SAASU,oBAAoBF,EAAkBF,OAG5CH,ECEWQ,GAClB,EAA8BP,EAAAA,SAA+B,MAA7D,eAAOQ,EAAP,KAAgBC,EAAhB,KAuBA,OArBAT,EAAAA,WAAgB,WACd,GAAID,EAAW,CACb,IADa,EAEPW,EAAiBC,KAAKC,MAC1BC,aAAaC,QAFS,qBAEmB,MAErCC,EAAsB,GALf,UAMOL,GANP,IAMb,2BAAoC,CAAC,IAA1BM,EAAyB,QAClCD,EAAWE,KAAK,CACdC,IAAKF,EAAME,IACXC,MAAOH,EAAMG,MACbC,UAAWJ,EAAMI,aAVR,8BAcTL,EAAWM,QACbZ,EAAWM,MAGd,CAAChB,KAGF,qBACEuB,GAAG,4BACH,kBAAgB,4BAFlB,WAIE,sDACEd,EAEEA,EAAQa,QACV,8BACE,4BACE,2BACE,sCACA,uCAGJ,2BACGb,EAAQe,KAAI,SAACC,GACZ,OACE,2BACE,yBACE,UAAC,KAAD,CAAMC,GAAID,EAAMN,IAAhB,UACGM,EAAML,MADT,KACgB,2BAAQK,EAAMN,YAGhC,wBAAKQ,GAAAA,CAAM,IAAIC,KAAKH,EAAMJ,YAAYQ,cAN/BJ,EAAMN,cAavB,SAACW,EAAD,0DAzBA,SAACA,EAAD,mDA+BR,SAASA,EAAT,GAA+B,IAAbC,EAAY,EAAZA,SAChB,OAAO,cAAGC,UAAU,eAAb,SAA6BD,IAxEtCJ,IAAAA,OAAaM","sources":["writers-homepage/hooks.tsx","writers-homepage/viewed-documents.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\n\nfunction getIsDocumentHidden() {\n  return !document.hidden;\n}\n\nexport function usePageVisibility() {\n  const [isVisible, setIsVisible] = React.useState(getIsDocumentHidden());\n  const onVisibilityChange = () => setIsVisible(getIsDocumentHidden());\n  useEffect(() => {\n    const visibilityChange = \"visibilitychange\";\n    document.addEventListener(visibilityChange, onVisibilityChange, false);\n    return () => {\n      document.removeEventListener(visibilityChange, onVisibilityChange);\n    };\n  });\n  return isVisible;\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport dayjs from \"dayjs\";\nimport relativeTime from \"dayjs/plugin/relativeTime\";\n\nimport { usePageVisibility } from \"./hooks\";\n\nimport \"./viewed-documents.scss\";\n\ndayjs.extend(relativeTime);\n\ntype Entry = {\n  url: string;\n  title: string;\n  timestamp: number;\n};\n\nexport default function ViewedDocuments() {\n  const isVisible = usePageVisibility();\n  const [entries, setEntries] = React.useState<Entry[] | null>(null);\n\n  React.useEffect(() => {\n    if (isVisible) {\n      const localStorageKey = \"viewed-documents\";\n      const previousVisits = JSON.parse(\n        localStorage.getItem(localStorageKey) || \"[]\"\n      );\n      const newEntries: Entry[] = [];\n      for (const visit of previousVisits) {\n        newEntries.push({\n          url: visit.url,\n          title: visit.title,\n          timestamp: visit.timestamp,\n        });\n      }\n\n      if (newEntries.length) {\n        setEntries(newEntries);\n      }\n    }\n  }, [isVisible]);\n\n  return (\n    <article\n      id=\"recently-viewed-documents\"\n      aria-labelledby=\"recently-viewed-documents\"\n    >\n      <h3>Recently viewed documents</h3>\n      {!entries ? (\n        <Banner>Loading recently viewed documents</Banner>\n      ) : entries.length ? (\n        <table>\n          <thead>\n            <tr>\n              <th>Document</th>\n              <th>When</th>\n            </tr>\n          </thead>\n          <tbody>\n            {entries.map((entry) => {\n              return (\n                <tr key={entry.url}>\n                  <td>\n                    <Link to={entry.url}>\n                      {entry.title} <small>{entry.url}</small>\n                    </Link>\n                  </td>\n                  <td>{dayjs(new Date(entry.timestamp)).fromNow()}</td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      ) : (\n        <Banner>No recently viewed documents at the moment</Banner>\n      )}\n    </article>\n  );\n}\n\nfunction Banner({ children }) {\n  return <p className=\"notification\">{children}</p>;\n}\n"],"names":["getIsDocumentHidden","document","hidden","ViewedDocuments","isVisible","React","setIsVisible","onVisibilityChange","useEffect","visibilityChange","addEventListener","removeEventListener","usePageVisibility","entries","setEntries","previousVisits","JSON","parse","localStorage","getItem","newEntries","visit","push","url","title","timestamp","length","id","map","entry","to","dayjs","Date","fromNow","Banner","children","className","relativeTime"],"sourceRoot":""}