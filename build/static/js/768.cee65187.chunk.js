"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[768],{3768:function(e,t,r){r.r(t),r.d(t,{default:function(){return $}});var n=r(1092),s=r(7791),i=r(6167),a=r(1e3),o=r(3400),l=r(8074),c=r(7557),d=r(4187),u=r(5809),f=r(1646),h=r.n(f),x=r(8208),m=r.n(x),p=r(7878);h().extend(m());var j="translations-dashboard-differences";function g(e,t){try{var r=JSON.parse(localStorage.getItem(j)||"{}");r[e]=Object.assign({},r[e]||{},t),localStorage.setItem(j,JSON.stringify(r))}catch(n){console.warn("Unable to save to localStorage",n)}}function v(){var e=(0,o.UO)().locale,t=void 0===e?"en-US":e,r=(0,a.lr)(),c=(0,u.Z)(r,1)[0],d=(0,o.s0)(),f=i.useState(null),h=(0,u.Z)(f,2),x=h[0],m=h[1];i.useEffect((function(){"en-us"===t.toLowerCase()&&d("/".concat(t,"/_translations"))}),[t,d]),i.useEffect((function(){var e="All translations";"en-us"!==t.toLowerCase()&&(e+=" for ".concat(t)),x&&(e="(".concat(x.counts.found.toLocaleString()," found) ").concat(e)),document.title=e}),[x,t]);var v=(0,l.ZP)("en-us"!==t.toLowerCase()?"/_translations/differences/?locale=".concat(t):null,function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((r=e.sent).ok){e.next=11;break}return e.t0=Error,e.t1="".concat(r.status," ("),e.next=8,r.text();case 8:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2,")"),new e.t0(e.t3);case 11:if((r.headers.get("content-type")||"").includes("application/json")){e.next=13;break}throw new Error("Response is not JSON (".concat(r.headers.get("content-type"),")"));case 13:return e.abrupt("return",r.json());case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{revalidateOnFocus:!1}),L=v.data,k=v.error,T=v.isValidating,U=i.useRef();i.useEffect((function(){if(t)if(L){if(L.counts.cacheMisses>0&&L.counts.cacheMisses===L.counts.total&&U.current){var e=(new Date).getTime()-U.current.getTime();g(t,{lastLoadTime:e})}}else U.current=new Date}),[t,L]),i.useEffect((function(){L&&m(L)}),[L]);var E=function(e){try{var t=JSON.parse(localStorage.getItem(j)||"{}");if(t)return t[e]}catch(r){console.warn("Unable to retrieve from localStorage",r)}return null}(t),R=(null===E||void 0===E?void 0:E.defaultSort)||"modified",C=(null===E||void 0===E?void 0:E.defaultSortReverse)||"false",D=c.get("sort")||R,O=JSON.parse(c.get("sortReverse")||C);return i.useEffect((function(){g(t,Object.assign({},E,{defaultSort:D,defaultSortReverse:O}))}),[t,D,O,E]),"en-us"===t.toLowerCase()?null:(0,p.jsxs)(b,{children:[x&&!k&&T&&(0,p.jsx)("p",{style:{float:"right"},children:"Reloading..."}),!L&&!k&&!x&&(0,p.jsx)(N,{estimate:E&&E.lastLoadTime||3e4}),x&&(0,p.jsxs)("p",{style:{textAlign:"right"},children:["Go to"," ",(0,p.jsxs)(a.rU,{to:"/".concat(t,"/_translations/missing"),children:["Missing translations for ",(0,p.jsx)("b",{children:t})]})]}),k&&(0,p.jsx)(S,{error:k}),x&&(0,p.jsxs)("div",{className:"filter-documents",children:[(0,p.jsx)(y,{}),(0,p.jsx)(I,{counts:x.counts,documents:x.documents,sort:D,sortReverse:O})]}),L&&(0,p.jsx)(w,{times:L.times})]})}function b(e){var t=e.children;return(0,p.jsx)("div",{className:"all-translations",children:(0,p.jsx)(d.R,{children:t})})}function S(e){var t=e.error;return(0,p.jsxs)("div",{className:"error-message search-error",children:[(0,p.jsx)("h3",{children:"Search error"}),(0,p.jsx)("pre",{children:t.toString()})]})}function w(e){var t,r=e.times;return(0,p.jsx)("div",{className:"search-times",children:(0,p.jsxs)("p",{children:["Time to find all documents ",(t=r.took,t>1e3?"".concat((t/1e3).toFixed(1)," seconds"):"".concat(Math.trunc(t)," milliseconds"))]})})}function N(e){var t=e.estimate,r=new Date,n=i.useState(new Date(r.getTime()+t)),s=(0,u.Z)(n,1)[0],a=i.useState(0),o=(0,u.Z)(a,2)[1];i.useEffect((function(){var e=setInterval((function(){o((function(e){return e+1}))}),1e3);return function(){return clearInterval(e)}}),[]);var l=s.getTime()-r.getTime(),c=(new Date).getTime()-r.getTime(),d=100*c/l;return(0,p.jsxs)("div",{className:"loading",children:[(0,p.jsxs)("progress",{id:"progress",max:"100",value:d,style:{margin:20},children:[d,"%"]}),(0,p.jsx)("br",{}),(0,p.jsxs)("small",{children:["Estimated time to finish: ",((l-c)/1e3).toFixed(0),"s"," ",c>l?(0,p.jsx)("span",{"aria-label":"weird",role:"img",children:"\ud83d\ude43"}):null]})]})}function y(){var e=(0,a.lr)(),t=(0,u.Z)(e,2),r=t[0],n=t[1],s=i.useState(r.get("title")||""),o=(0,u.Z)(s,2),l=o[0],c=o[1],d=i.useState(r.get("url")||""),f=(0,u.Z)(d,2),h=f[0],x=f[1],m=i.useState(r.get("differences")||""),j=(0,u.Z)(m,2),g=j[0],v=j[1];function b(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,a.fW)(r),s=0,i=[["url",h],["title",l],["differences",g]];s<i.length;s++){var o=(0,u.Z)(i[s],2),c=o[0],d=o[1];!e&&d?t.set(c,d):t.delete(c)}t.delete("page"),n(t)}return(0,p.jsxs)("div",{className:"filters",children:[(0,p.jsx)("h3",{children:"Filters"}),(0,p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),b()},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:"Document"}),(0,p.jsx)("input",{type:"search",placeholder:"Filter by document URI",value:h,onChange:function(e){x(e.target.value)},onBlur:function(){return b()}}),(0,p.jsx)("input",{type:"search",placeholder:"Filter by document title",value:l,onChange:function(e){c(e.target.value)},onBlur:function(){return b()}})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:"Differences"}),(0,p.jsx)("input",{type:"text",placeholder:"E.g. >0 or >=5",value:g,onChange:function(e){v(e.target.value)},onBlur:function(){return b()}})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:"\xa0"}),(0,p.jsx)("button",{type:"submit",children:"Filter now"})," ",(h||l)&&(0,p.jsx)("button",{type:"button",onClick:function(){x(""),c(""),v(""),b(!0)},children:"Reset filters"})]})]})]})}function I(e){var t=e.counts,r=e.documents,n=e.sort,s=e.sortReverse,i=(0,a.lr)(),o=(0,u.Z)(i,2),l=o[0],c=o[1],d=parseInt(l.get("page")||"1",10),f=parseInt(l.get("pageSize")||"20",10),h=l.get("title")||"",x=l.get("url")||"",m=l.get("differences")||"",j=function(e){function t(e){if(!e)throw new Error("Can't be empty");var t=parseInt(e,10);if(isNaN(t))throw new Error("'".concat(e,"' not a valid number"));return t}try{return e.startsWith(">=")?{operation:"gte",value:t(e.replace(">=",""))}:e.startsWith(">")?{operation:"gt",value:t(e.replace(">",""))}:e.startsWith("<=")?{operation:"lte",value:t(e.replace("<=",""))}:e.startsWith("<")?{operation:"lt",value:t(e.replace("<",""))}:e.startsWith("==")||e.startsWith("=")?{operation:"eq",value:t(e.replace(/=/g,""))}:e?{operation:"eq",value:t(e)}:null}catch(r){return console.warn(r),null}}(m);function g(e){var t=e.id,r=e.title;return(0,p.jsx)("th",{onClick:function(){c(n===t?(0,a.fW)({sort:t,sortReverse:JSON.stringify(!s)}):(0,a.fW)({sort:t}))},className:"sortable ".concat(n===t?"active":""," ").concat(n===t&&s?"reverse":""),children:r})}var v=r.filter((function(e){return!(h&&!e.title.toLowerCase().includes(h.toLowerCase()))&&(!(x&&!e.mdn_url.toLowerCase().includes(x.toLowerCase()))&&!(j&&!function(e,t){if("eq"===t.operation){if(e!==t.value)return!1}else if("gt"===t.operation){if(!(e>t.value))return!1}else if("gte"===t.operation){if(!(e>=t.value))return!1}else if("lt"===t.operation){if(!(e<t.value))return!1}else{if("lte"!==t.operation)throw new Error("Not implemented operation '".concat(t.operation,"'"));if(!(e<=t.value))return!1}return!0}(e.differences.total,j)))})).sort((function(e,t){var r=s?-1:1;if("modified"===n){var i=new Date(e.edits.modified);return r*(new Date(t.edits.modified).getTime()-i.getTime())}if("popularity"===n){var a=e.popularity.value;return r*(t.popularity.value-a)}if("differences"===n){var o=e.differences.total;return r*(t.differences.total-o)}if("title"===n){var l=e.title,c=t.title;return r*l.localeCompare(c)}if("mdn_url"===n){var d=e.mdn_url,u=t.mdn_url;return r*d.localeCompare(u)}throw new Error("Unrecognized sort '".concat(n,"'"))})),b=Math.ceil(t.found/f);return(0,p.jsxs)("div",{className:"documents",children:[(0,p.jsxs)("h3",{children:["Documents found (",v.length.toLocaleString(),")"," ",d>1&&(0,p.jsxs)("span",{className:"page",children:["page ",d]})," ",(0,p.jsxs)("small",{children:["of ",t.total.toLocaleString()," in total"]})]}),m&&!j&&(0,p.jsxs)("div",{className:"error-message",children:[(0,p.jsx)("h3",{children:"Invalid differences filter"}),(0,p.jsxs)("p",{children:["The ",(0,p.jsx)("i",{children:"differences"})," filter can't be parsed.",(0,p.jsx)("br",{}),(0,p.jsx)("code",{children:m})]})]}),(0,p.jsxs)("table",{children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)(g,{id:"title",title:"Document"}),(0,p.jsx)(g,{id:"popularity",title:"Popularity"}),(0,p.jsx)(g,{id:"modified",title:"Last modified"}),(0,p.jsx)(g,{id:"differences",title:"Differences"})]})}),(0,p.jsx)("tbody",{children:v.slice((d-1)*f,d*f).map((function(e){return(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{children:[(0,p.jsx)("span",{className:"document-title-preview",children:h?(0,p.jsx)(k,{text:e.title,highlight:h}):e.title}),(0,p.jsx)("br",{}),(0,p.jsx)(a.rU,{to:"".concat(e.mdn_url,"#_flaws"),title:e.title,target:"_blank",children:(0,p.jsx)(T,{uri:e.mdn_url,filterURL:x})})]}),(0,p.jsxs)("td",{title:e.popularity.ranking?"Meaning there are ".concat(e.popularity.ranking-1," more popular pages than this"):"Meaning it has no ranking. Most likely a very rare (or new) document",children:[e.popularity.ranking?"".concat(U(e.popularity.ranking)):"n/a"," ",(0,p.jsxs)("small",{title:"For the parent document",children:["(",e.popularity.parentRanking?"".concat(U(e.popularity.parentRanking)):"n/a",")"]})]}),(0,p.jsx)("td",{children:(0,p.jsx)(L,{edits:e.edits})}),(0,p.jsx)("td",{children:e.differences.total.toLocaleString()})]},e.mdn_url)}))})]}),b>1&&(0,p.jsxs)("p",{className:"pagination",children:[(0,p.jsx)(E,{number:1,disabled:1===d,children:"First page"})," ",d>2&&(0,p.jsxs)(E,{number:d-1,children:["Previous page (",d-1,")"]})," ",(0,p.jsxs)(E,{number:d+1,disabled:d+1>b,children:["Next page (",d+1,")"]})]})]})}function L(e){var t=e.edits,r=h()(t.modified),n=h()(t.parentModified);return(0,p.jsxs)("span",{className:"last_modified ".concat(n<r?"ahead":"behind"),children:[(0,p.jsx)("a",{href:t.commitURL,target:"_blank",rel:"noreferrer",children:(0,p.jsx)("time",{dateTime:r.toISOString(),title:r.toISOString(),children:r.fromNow()})}),(0,p.jsx)("br",{}),(0,p.jsx)("a",{href:t.parentCommitURL,target:"_blank",rel:"noreferrer",children:(0,p.jsx)("small",{children:(0,p.jsxs)("time",{dateTime:n.toISOString(),title:n.toISOString(),children:["en-US ",n.fromNow()]})})})]})}function k(e){var t=e.text,r=e.highlight,n=t.split(new RegExp("(".concat(r,")"),"gi"));return(0,p.jsxs)("span",{children:[" ",n.map((function(e,t){return(0,p.jsx)("span",{style:e.toLowerCase()===r.toLowerCase()?{fontWeight:"bold"}:{},children:e},t)}))," "]})}function T(e){var t=e.uri,r=e.filterURL,n=t.split(/\/docs\//,2),s=(0,u.Z)(n,2),i=s[0],a=s[1];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("span",{className:"url-prefix",children:[i,"/docs/"]}),(0,p.jsx)("span",{className:"url-slug",children:r?(0,p.jsx)(k,{text:a,highlight:r}):a})]})}function U(e){var t=["th","st","nd","rd"],r=e%100;return e.toLocaleString()+(t[(r-20)%10]||t[r]||t[0])}function E(e){var t=e.number,r=e.disabled,n=e.children,s=(0,a.lr)(),i=(0,u.Z)(s,1)[0],o=(0,a.fW)(i);return t>1?o.set("page","".concat(t)):o.delete("page"),(0,p.jsx)(a.rU,{to:"?"+o.toString(),className:r?"disabled":"",onClick:function(e){r&&e.preventDefault();var t=document.querySelector("div.all-translations");t&&t.scrollIntoView({behavior:"smooth"})},children:n})}h().extend(m());var R="translations-dashboard-missing";function C(e,t){try{var r=JSON.parse(localStorage.getItem(R)||"{}");r[e]=Object.assign({},r[e]||{},t),localStorage.setItem(R,JSON.stringify(r))}catch(n){console.warn("Unable to save to localStorage",n)}}function D(){var e=(0,o.UO)().locale,t=void 0===e?"en-US":e,r=(0,a.lr)(),c=(0,u.Z)(r,1)[0],d=(0,o.s0)(),f=i.useState(null),h=(0,u.Z)(f,2),x=h[0],m=h[1];i.useEffect((function(){"en-us"===t.toLowerCase()&&d("/".concat(t,"/_translations"))}),[t,d]),i.useEffect((function(){var e="Missing translations";"en-us"!==t.toLowerCase()&&(e+=" for ".concat(t)),x&&(e="(".concat(x.counts.missing.toLocaleString()," found) ").concat(e)),document.title=e}),[x,t]);var j=(0,l.ZP)("en-us"!==t.toLowerCase()?"/_translations/missing/?locale=".concat(t):null,function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((r=e.sent).ok){e.next=11;break}return e.t0=Error,e.t1="".concat(r.status," ("),e.next=8,r.text();case 8:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2,")"),new e.t0(e.t3);case 11:if((r.headers.get("content-type")||"").includes("application/json")){e.next=13;break}throw new Error("Response is not JSON (".concat(r.headers.get("content-type"),")"));case 13:return e.abrupt("return",r.json());case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{revalidateOnFocus:!1}),g=j.data,v=j.error,b=j.isValidating,S=i.useRef();i.useEffect((function(){if(t)if(g){if(g.counts.cacheMisses>0&&g.counts.cacheMisses===g.counts.total&&S.current){var e=(new Date).getTime()-S.current.getTime();C(t,{lastLoadTime:e})}}else S.current=new Date}),[t,g]),i.useEffect((function(){g&&m(g)}),[g]);var w=function(e){try{var t=JSON.parse(localStorage.getItem(R)||"{}");if(t)return t[e]}catch(r){console.warn("Unable to retrieve from localStorage",r)}return null}(t),N=(null===w||void 0===w?void 0:w.defaultSort)||"popularity",y=(null===w||void 0===w?void 0:w.defaultSortReverse)||"false",I=c.get("sort")||N,L=JSON.parse(c.get("sortReverse")||y);return i.useEffect((function(){C(t,Object.assign({},w,{defaultSort:I,defaultSortReverse:L}))}),[t,I,L,w]),"en-us"===t.toLowerCase()?null:(0,p.jsxs)(O,{children:[x&&!v&&b&&(0,p.jsx)("p",{style:{float:"right"},children:"Reloading..."}),!g&&!v&&!x&&(0,p.jsx)(F,{estimate:w&&w.lastLoadTime||3e4}),x&&(0,p.jsxs)("p",{style:{textAlign:"right"},children:["Go to"," ",(0,p.jsxs)(a.rU,{to:"/".concat(t,"/_translations/differences"),children:["Translation differences for ",(0,p.jsx)("b",{children:t})]})]}),v&&(0,p.jsx)(_,{error:v}),x&&(0,p.jsxs)("div",{className:"filter-documents",children:[(0,p.jsx)(P,{}),(0,p.jsx)(M,{counts:x.counts,documents:x.missingDocuments,sort:I,sortReverse:L})]}),g&&(0,p.jsx)(Z,{times:g.times})]})}function O(e){var t=e.children;return(0,p.jsx)("div",{className:"missing-translations",children:(0,p.jsx)(d.R,{children:t})})}function _(e){var t=e.error;return(0,p.jsxs)("div",{className:"error-message search-error",children:[(0,p.jsx)("h3",{children:"Search error"}),(0,p.jsx)("pre",{children:t.toString()})]})}function Z(e){var t,r=e.times;return(0,p.jsx)("div",{className:"search-times",children:(0,p.jsxs)("p",{children:["Time to find all documents ",(t=r.took,t>1e3?"".concat((t/1e3).toFixed(1)," seconds"):"".concat(Math.trunc(t)," milliseconds"))]})})}function F(e){var t=e.estimate,r=new Date,n=i.useState(new Date(r.getTime()+t)),s=(0,u.Z)(n,1)[0],a=i.useState(0),o=(0,u.Z)(a,2)[1];i.useEffect((function(){var e=setInterval((function(){o((function(e){return e+1}))}),1e3);return function(){return clearInterval(e)}}),[]);var l=s.getTime()-r.getTime(),c=(new Date).getTime()-r.getTime(),d=100*c/l;return(0,p.jsxs)("div",{className:"loading",children:[(0,p.jsxs)("progress",{id:"progress",max:"100",value:d,style:{margin:20},children:[d,"%"]}),(0,p.jsx)("br",{}),(0,p.jsxs)("small",{children:["Estimated time to finish: ",((l-c)/1e3).toFixed(0),"s"," ",c>l?(0,p.jsx)("span",{"aria-label":"weird",role:"img",children:"\ud83d\ude43"}):null]})]})}function P(){var e=(0,a.lr)(),t=(0,u.Z)(e,2),r=t[0],n=t[1],s=i.useState(r.get("title")||""),o=(0,u.Z)(s,2),l=o[0],c=o[1],d=i.useState(r.get("url")||""),f=(0,u.Z)(d,2),h=f[0],x=f[1];function m(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,a.fW)(r),s=0,i=[["url",h],["title",l]];s<i.length;s++){var o=(0,u.Z)(i[s],2),c=o[0],d=o[1];!e&&d?t.set(c,d):t.delete(c)}t.delete("page"),n(t)}return(0,p.jsxs)("div",{className:"filters",children:[(0,p.jsx)("h3",{children:"Filters"}),(0,p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m()},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:"Document"}),(0,p.jsx)("input",{type:"search",placeholder:"Filter by document URI",value:h,onChange:function(e){x(e.target.value)},onBlur:function(){return m()}}),(0,p.jsx)("input",{type:"search",placeholder:"Filter by document title",value:l,onChange:function(e){c(e.target.value)},onBlur:function(){return m()}})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{children:"\xa0"}),(0,p.jsx)("button",{type:"submit",children:"Filter now"})," ",(h||l)&&(0,p.jsx)("button",{type:"button",onClick:function(){x(""),c(""),m(!0)},children:"Reset filters"})]})]})]})}function M(e){var t=e.counts,r=e.documents,n=e.sort,s=e.sortReverse,i=(0,a.lr)(),o=(0,u.Z)(i,2),l=o[0],c=o[1],d=parseInt(l.get("page")||"1",10),f=parseInt(l.get("pageSize")||"20",10),h=l.get("title")||"",x=l.get("url")||"",m=function(e){function t(e){if(!e)throw new Error("Can't be empty");var t=parseInt(e,10);if(isNaN(t))throw new Error("'".concat(e,"' not a valid number"));return t}try{return e.startsWith(">=")?{operation:"gte",value:t(e.replace(">=",""))}:e.startsWith(">")?{operation:"gt",value:t(e.replace(">",""))}:e.startsWith("<=")?{operation:"lte",value:t(e.replace("<=",""))}:e.startsWith("<")?{operation:"lt",value:t(e.replace("<",""))}:e.startsWith("==")||e.startsWith("=")?{operation:"eq",value:t(e.replace(/=/g,""))}:e?{operation:"eq",value:t(e)}:null}catch(r){return console.warn(r),null}}(l.get("differences")||"");function j(e){var t=e.id,r=e.title;return(0,p.jsx)("th",{onClick:function(){c(n===t?(0,a.fW)({sort:t,sortReverse:JSON.stringify(!s)}):(0,a.fW)({sort:t}))},className:"sortable ".concat(n===t?"active":""," ").concat(n===t&&s?"reverse":""),children:r})}var g=r.filter((function(e){return!(h&&!e.title.toLowerCase().includes(h.toLowerCase()))&&(!(x&&!e.mdn_url.toLowerCase().includes(x.toLowerCase()))&&!(m&&!function(e,t){if("eq"===t.operation){if(e!==t.value)return!1}else if("gt"===t.operation){if(!(e>t.value))return!1}else if("gte"===t.operation){if(!(e>=t.value))return!1}else if("lt"===t.operation){if(!(e<t.value))return!1}else{if("lte"!==t.operation)throw new Error("Not implemented operation '".concat(t.operation,"'"));if(!(e<=t.value))return!1}return!0}(e.differences.total,m)))})).sort((function(e,t){var r=s?-1:1;if("modified"===n){var i=new Date(e.edits.modified);return r*(new Date(t.edits.modified).getTime()-i.getTime())}if("popularity"===n){var a=e.popularity.value;return r*(t.popularity.value-a)}if("differences"===n){var o=e.differences.total;return r*(t.differences.total-o)}if("title"===n){var l=e.title,c=t.title;return r*l.localeCompare(c)}if("mdn_url"===n){var d=e.mdn_url,u=t.mdn_url;return r*d.localeCompare(u)}throw new Error("Unrecognized sort '".concat(n,"'"))})),v=Math.ceil(t.total/f);return(0,p.jsxs)("div",{className:"documents",children:[(0,p.jsxs)("h3",{children:[t.missing.toLocaleString()," missing translations (of"," ",t.total.toLocaleString()," possible)"]}),(0,p.jsxs)("table",{children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)(j,{id:"title",title:"Document"}),(0,p.jsx)(j,{id:"popularity",title:"Popularity"}),(0,p.jsx)(j,{id:"modified",title:"Last modified"})]})}),(0,p.jsx)("tbody",{children:g.slice((d-1)*f,d*f).map((function(e){return(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{children:[(0,p.jsx)("span",{className:"document-title-preview",children:h?(0,p.jsx)(J,{text:e.title,highlight:h}):e.title}),(0,p.jsx)("br",{}),(0,p.jsx)(a.rU,{to:"".concat(e.mdn_url,"#_flaws"),title:e.title,target:"_blank",children:(0,p.jsx)(K,{uri:e.mdn_url,filterURL:x})})]}),(0,p.jsxs)("td",{title:e.popularity.ranking?"Meaning there are ".concat(e.popularity.ranking-1," more popular pages than this"):"Meaning it has no ranking. Most likely a very rare (or new) document",children:[e.popularity.ranking?"".concat(V(e.popularity.ranking)):"n/a"," "]}),(0,p.jsx)("td",{children:(0,p.jsx)(W,{edits:e.edits})})]},e.mdn_url)}))})]}),v>1&&(0,p.jsxs)("p",{className:"pagination",children:[(0,p.jsx)(z,{number:1,disabled:1===d,children:"First page"})," ",d>2&&(0,p.jsxs)(z,{number:d-1,children:["Previous page (",d-1,")"]})," ",(0,p.jsxs)(z,{number:d+1,disabled:d+1>v,children:["Next page (",d+1,")"]})]})]})}function W(e){var t=e.edits,r=h()(t.modified);return(0,p.jsx)("span",{className:"last_modified",children:(0,p.jsx)("a",{href:t.commitURL,target:"_blank",rel:"noreferrer",children:(0,p.jsx)("time",{dateTime:r.toISOString(),title:r.toISOString(),children:r.fromNow()})})})}function J(e){var t=e.text,r=e.highlight,n=t.split(new RegExp("(".concat(r,")"),"gi"));return(0,p.jsxs)("span",{children:[" ",n.map((function(e,t){return(0,p.jsx)("span",{style:e.toLowerCase()===r.toLowerCase()?{fontWeight:"bold"}:{},children:e},t)}))," "]})}function K(e){var t=e.uri,r=e.filterURL,n=t.split(/\/docs\//,2),s=(0,u.Z)(n,2),i=s[0],a=s[1];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("span",{className:"url-prefix",children:[i,"/docs/"]}),(0,p.jsx)("span",{className:"url-slug",children:r?(0,p.jsx)(J,{text:a,highlight:r}):a})]})}function V(e){var t=["th","st","nd","rd"],r=e%100;return e.toLocaleString()+(t[(r-20)%10]||t[r]||t[0])}function z(e){var t=e.number,r=e.disabled,n=e.children,s=(0,a.lr)(),i=(0,u.Z)(s,1)[0],o=(0,a.fW)(i);return t>1?o.set("page","".concat(t)):o.delete("page"),(0,p.jsx)(a.rU,{to:"?"+o.toString(),className:r?"disabled":"",onClick:function(e){r&&e.preventDefault();var t=document.querySelector("div.all-translations");t&&t.scrollIntoView({behavior:"smooth"})},children:n})}var A="translations-dashboard-sections";function G(){var e=(0,o.UO)().locale,t=void 0===e?"en-US":e,r=(0,a.lr)(),c=(0,u.Z)(r,1)[0],d=(0,o.s0)(),f=i.useState(null),h=(0,u.Z)(f,2),x=h[0],m=h[1],j=c.get("section")||"";i.useEffect((function(){"en-us"===t.toLowerCase()&&d("/".concat(t,"/_translations"))}),[t,d]),i.useEffect((function(){var e="Translation dashboard ";"en-us"!==t.toLowerCase()&&(e+=" for ".concat(t)),""!==j&&(e+=" - section ".concat(j)),document.title=e}),[x,t,j]);var g=(0,l.ZP)("en-us"!==t.toLowerCase()?"/_translations/dashboard/?locale=".concat(t,"&section=").concat(j):null,function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((r=e.sent).ok){e.next=11;break}return e.t0=Error,e.t1="".concat(r.status," ("),e.next=8,r.text();case 8:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2,")"),new e.t0(e.t3);case 11:if((r.headers.get("content-type")||"").includes("application/json")){e.next=13;break}throw new Error("Response is not JSON (".concat(r.headers.get("content-type"),")"));case 13:return e.abrupt("return",r.json());case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{revalidateOnFocus:!1}),v=g.data,b=g.error,S=g.isValidating;i.useEffect((function(){v&&m(v)}),[v]);var w=function(e){try{var t=JSON.parse(localStorage.getItem(A)||"{}");if(t)return t[e]}catch(r){console.warn("Unable to retrieve from localStorage",r)}return null}(t),N=(null===w||void 0===w?void 0:w.defaultSort)||"url",y=(null===w||void 0===w?void 0:w.defaultSortReverse)||"false",I=c.get("sort")||N,L=JSON.parse(c.get("sortReverse")||y);if(i.useEffect((function(){!function(e,t){try{var r=JSON.parse(localStorage.getItem(A)||"{}");r[e]=Object.assign({},r[e]||{},t),localStorage.setItem(A,JSON.stringify(r))}catch(n){console.warn("Unable to save to localStorage",n)}}(t,Object.assign({},w,{defaultSort:I,defaultSortReverse:L}))}),[t,I,L,w]),"en-us"===t.toLowerCase())return null;var k="/";if(j.split("/").length>2){var T=j.split("/");T.pop(),k=T.join("/")}return(0,p.jsxs)(q,{children:[x&&!b&&S&&(0,p.jsx)("p",{style:{float:"right"},children:"Reloading..."}),!v&&!b&&!x&&(0,p.jsx)(H,{}),x&&(0,p.jsxs)("p",{style:{textAlign:"right"},children:["Go to"," ",(0,p.jsxs)(a.rU,{to:"/".concat(t,"/_translations/differences"),children:["Translation differences for ",(0,p.jsx)("b",{children:t})]})," / ",(0,p.jsxs)(a.rU,{to:"/".concat(t,"/_translations/missing"),children:["Missing translations for ",(0,p.jsx)("b",{children:t})]})]}),b&&(0,p.jsx)(Y,{error:b}),x&&(0,p.jsxs)("div",{className:"filter-documents",children:[(0,p.jsx)(B,{l10nKPIs:x.l10nKPIs,section:j,parentSection:k}),(0,p.jsx)(Q,{sections:x.sections,currentSection:j}),(0,p.jsx)(X,{documents:x.detailDocuments,sort:I,sortReverse:L,locale:t})]})]})}function q(e){var t=e.children;return(0,p.jsx)("div",{className:"dashboard-section-translations",children:(0,p.jsx)(d.R,{children:t})})}function Y(e){var t=e.error;return(0,p.jsxs)("div",{className:"error-message",children:[(0,p.jsx)("h3",{children:"Error"}),(0,p.jsx)("pre",{children:t.toString()})]})}function H(){return(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"progress",children:"Loading"}),(0,p.jsx)("progress",{id:"progress",max:"100",style:{margin:20}})]})}function B(e){var t=e.l10nKPIs,r=e.section,n=e.parentSection,s=100*(t.total-t.missing)/t.total,i=s.toFixed(1)+"%",a=100*t.upToDate/t.total,o=a.toFixed(1)+"%";return(0,p.jsxs)("div",{className:"documents",children:[(0,p.jsxs)("h2",{children:["Localization dashboard for: ",r||"/"]}),(0,p.jsxs)("p",{children:["Parent section:"," ",(0,p.jsx)("a",{href:"dashboard?section=".concat(n),children:n})]}),(0,p.jsx)("h3",{children:"Summary"}),(0,p.jsxs)("dl",{children:[(0,p.jsx)("dt",{children:"Total number of pages"}),(0,p.jsx)("dd",{children:t.total}),(0,p.jsx)("dt",{children:"Number of untranslated pages"}),(0,p.jsx)("dd",{children:t.missing}),(0,p.jsx)("dt",{children:"Number of outdated pages (older than English in Git) "}),(0,p.jsx)("dd",{children:t.outOfDate}),(0,p.jsx)("dt",{children:"Number of up-to-date pages"}),(0,p.jsx)("dd",{children:t.upToDate}),(0,p.jsx)("dt",{children:(0,p.jsx)("label",{htmlFor:"completeness",children:"Localization completeness"})}),(0,p.jsxs)("dd",{children:[(0,p.jsx)("progress",{id:"completeness",max:"100",value:s,children:i})," ",i]}),(0,p.jsx)("dt",{children:(0,p.jsx)("label",{htmlFor:"freshness",children:"Localization freshness"})}),(0,p.jsxs)("dd",{children:[(0,p.jsx)("progress",{id:"freshness",max:"100",value:a,children:o})," ",o]})]})]})}function Q(e){var t=e.sections,r=e.currentSection;return t.length>0?(0,p.jsxs)("section",{id:"subsection-table",children:[(0,p.jsx)("h3",{children:"Subsections"}),(0,p.jsxs)("table",{children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"Section"}),(0,p.jsx)("th",{children:"Total / Untranslated / Out of date"}),(0,p.jsx)("th",{children:"Completeness"}),(0,p.jsx)("th",{children:"Freshness"})]})}),(0,p.jsx)("tbody",{children:t.sort((function(e,t){return t.l10nKPIs.total-e.l10nKPIs.total})).map((function(e){var t=100*(e.l10nKPIs.total-e.l10nKPIs.missing)/e.l10nKPIs.total,n=t.toFixed(1)+"%",s=100*e.l10nKPIs.upToDate/e.l10nKPIs.total,i=s.toFixed(1)+"%",a="dashboard?section=%2F"+encodeURIComponent(e.name);return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("a",{href:a,children:e.name.replace(r.slice(1),"").replace("/","")})}),(0,p.jsxs)("td",{children:[e.l10nKPIs.total," / ",e.l10nKPIs.missing," /"," ",e.l10nKPIs.outOfDate]}),(0,p.jsxs)("td",{children:[(0,p.jsx)("progress",{max:"100",value:t,children:n})," ",n]}),(0,p.jsxs)("td",{children:[(0,p.jsx)("progress",{max:"100",value:s,children:i})," ",i]})]},e.name)}))})]})]}):null}function X(e){var t=e.documents,r=e.sort,n=e.sortReverse,s=e.locale,i=(0,a.lr)(),o=(0,u.Z)(i,2),l=o[0],c=o[1],d=l.get("section")||"";function f(e){var t=e.id,s=e.title;return(0,p.jsx)("th",{onClick:function(){c(r===t?(0,a.fW)({sort:t,sortReverse:JSON.stringify(!n),section:d}):(0,a.fW)({sort:t,section:d}))},className:"sortable ".concat(r===t?"active":""," ").concat(r===t&&n?"reverse":""),children:s})}return t.map((function(e){if(e.info.localeInfo){var t=new Date(e.info.localeInfo.modified),r=new Date(e.info.defaultLocaleInfo.modified),n=t.getTime()-r.getTime();e.info.dateDiff=n}else e.info.dateDiff=Number.POSITIVE_INFINITY;return e})),(0,p.jsxs)("section",{id:"documents-table",children:[(0,p.jsx)("h3",{children:"List of direct subpages"}),(0,p.jsxs)("table",{children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)(f,{id:"url",title:"Slug"}),(0,p.jsx)(f,{id:"enMDNURL",title:"English doc on MDN"}),(0,p.jsx)(f,{id:"enCommitGHURL",title:"English doc commit on GitHub"}),(0,p.jsx)(f,{id:"localURL",title:"Local localized doc"}),(0,p.jsx)(f,{id:"localMDNURL",title:"Localized doc on MDN"}),(0,p.jsx)(f,{id:"localCommitGHURL",title:"Localized doc commit on GitHub"}),(0,p.jsx)(f,{id:"popularityEn",title:"Popularity rank (en-US)"}),(0,p.jsx)(f,{id:"popularityLocale",title:"Popularity rank ({locale})"}),(0,p.jsx)(f,{id:"dateDiff",title:"Date delta"})]})}),(0,p.jsx)("tbody",{children:t.sort((function(e,t){var s,i,a=n?-1:1;if("dateDiff"===r){var o=e.info.dateDiff||Number.POSITIVE_INFINITY;return a*((t.info.dateDiff||Number.POSITIVE_INFINITY)-o)}if("popularityLocale"===r)return a*(((null===(s=e.info.localePopularity)||void 0===s?void 0:s.ranking)||Number.POSITIVE_INFINITY)-((null===(i=t.info.localePopularity)||void 0===i?void 0:i.ranking)||Number.POSITIVE_INFINITY));if("popularityEn"===r)return a*((e.info.popularity.ranking||Number.POSITIVE_INFINITY)-(t.info.popularity.ranking||Number.POSITIVE_INFINITY));if("url"===r){var l=e.url,c=t.url;return a*l.localeCompare(c)}throw new Error("Unrecognized sort '".concat(r,"'"))})).map((function(e){var t,r="https://developer.mozilla.org"+e.url,n=e.info.defaultLocaleInfo.commitURL.split("commit/")[1].substring(0,7),i=null===(t=e.info.localeInfo)||void 0===t?void 0:t.commitURL.split("commit/")[1].substring(0,7),a="Untranslated";if(e.info.localeInfo){var o,l=null!==(o=e.info.dateDiff)&&void 0!==o?o:Number.POSITIVE_INFINITY;if(a="Out of date",l>0)a="Fresher than English";else if(l>-26784e5){var c=Math.round(-l/864e5);a=c+" day"+(c>1?"s":"")}else{var d=Math.round(-l/2592e6);a=d+" month"+(d>1?"s":"")}}return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:(0,p.jsx)("a",{href:e.url,children:e.url})}),(0,p.jsx)("td",{children:(0,p.jsx)("a",{href:r,children:"English current MDN page"})}),(0,p.jsx)("td",{children:(0,p.jsxs)("a",{href:e.info.defaultLocaleInfo.commitURL,children:["GitHub link for ",(0,p.jsx)("code",{children:n})]})}),(0,p.jsx)("td",{children:e.info.localeInfo&&(0,p.jsxs)("a",{href:e.url.replace("/en-US/","/"+s+"/"),children:["Local ",s," page"]})}),(0,p.jsx)("td",{children:e.info.localeInfo&&(0,p.jsx)("a",{href:r.replace("/en-US/","/"+s+"/"),children:"Locale current MDN page"})}),(0,p.jsx)("td",{children:e.info.localeInfo&&(0,p.jsxs)("a",{href:e.info.localeInfo.commitURL,children:["GitHub link for ",(0,p.jsx)("code",{children:i})]})}),(0,p.jsx)("td",{children:e.info.popularity.ranking}),(0,p.jsx)("td",{children:e.info.localePopularity&&e.info.localePopularity.ranking}),(0,p.jsx)("td",{children:a})]},e.url)}))})]})]})}function $(){return(0,p.jsx)(te,{children:(0,p.jsxs)(o.Z5,{children:[(0,p.jsx)(o.AW,{path:"/",element:(0,p.jsx)(ee,{})}),(0,p.jsx)(o.AW,{path:"differences",element:(0,p.jsx)(v,{})}),(0,p.jsx)(o.AW,{path:"missing",element:(0,p.jsx)(D,{})}),(0,p.jsx)(o.AW,{path:"dashboard",element:(0,p.jsx)(G,{})})]})})}function ee(){var e=(0,o.UO)().locale,t=void 0===e?"en-US":e;i.useEffect((function(){var e="All translations";"en-us"!==t.toLowerCase()&&(e+=" for ".concat(t)),document.title=e}),[t]);var r=(0,l.ZP)("en-us"===t.toLowerCase()?"/_translations/":null,function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if((r=e.sent).ok){e.next=11;break}return e.t0=Error,e.t1="".concat(r.status," ("),e.next=8,r.text();case 8:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2,")"),new e.t0(e.t3);case 11:return e.abrupt("return",r.json());case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d=r.data,u=r.error;return"en-us"===t.toLowerCase()?(0,p.jsxs)(p.Fragment,{children:[!d&&!u&&(0,p.jsx)(c.g,{}),u&&(0,p.jsxs)("div",{className:"error-message",children:[(0,p.jsx)("h3",{children:"Server error"}),(0,p.jsx)("pre",{children:u.toString()})]}),d&&(0,p.jsx)(re,{locales:d.locales})]}):(0,p.jsxs)("div",{className:"translation-choices",children:[(0,p.jsx)(a.rU,{to:"/".concat(t,"/_translations/differences"),className:"button",children:"Translation differences"})," ",(0,p.jsx)(a.rU,{to:"/".concat(t,"/_translations/missing"),className:"button",children:"Missing translations"})," ",(0,p.jsx)(a.rU,{to:"/".concat(t,"/_translations/dashboard"),className:"button",children:"Dashboard"})]})}function te(e){var t=e.children;return(0,p.jsx)("div",{className:"all-translations",children:(0,p.jsx)(d.R,{children:t})})}function re(e){var t=e.locales;return(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{children:"Select locale"}),(0,p.jsx)("table",{children:(0,p.jsx)("tbody",{children:t.map((function(e){return(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{children:[(0,p.jsxs)("b",{children:[e.language.English," (",e.locale,")"]})," ",!e.isActive&&(0,p.jsx)("small",{children:"not active"})]}),(0,p.jsxs)("td",{children:[e.count.toLocaleString()," documents"]}),(0,p.jsxs)("td",{children:[(0,p.jsx)(a.rU,{to:"/".concat(e.locale,"/_translations/differences"),children:"Translation differences"})," "]}),(0,p.jsxs)("td",{children:[(0,p.jsx)(a.rU,{to:"/".concat(e.locale,"/_translations/missing"),children:"Missing translations"})," "]}),(0,p.jsxs)("td",{children:[(0,p.jsx)(a.rU,{to:"/".concat(e.locale,"/_translations/dashboard"),children:"Dashboard"})," "]})]},e.locale)}))})})]})}}}]);
//# sourceMappingURL=768.cee65187.chunk.js.map